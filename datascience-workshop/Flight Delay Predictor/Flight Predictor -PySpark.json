{"paragraphs":[{"text":"%angular\n\n<h3>References:</h3>\n<a href=\"https://hortonworks.com/tutorial/predicting-airline-delays-using-sparkr/\" target=\"_blank\">Predicting Airline Delays using SparkR</a>\n<br><a href=\"http://spark.apache.org/docs/latest/programming-guide.html\" target=\"_blank\">Spark Documentation</a>\n<br><a href=\"http://spark.apache.org/docs/latest/api/python/index.html\" target=\"_blank\">PySpark Documentation</a>\n<br>","user":"admin","dateUpdated":"2018-04-24T16:44:40+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<h3>References:</h3>\n<a href=\"https://hortonworks.com/tutorial/predicting-airline-delays-using-sparkr/\" target=\"_blank\">Predicting Airline Delays using SparkR</a>\n<br><a href=\"http://spark.apache.org/docs/latest/programming-guide.html\" target=\"_blank\">Spark Documentation</a>\n<br><a href=\"http://spark.apache.org/docs/latest/api/python/index.html\" target=\"_blank\">PySpark Documentation</a>\n<br>"}]},"apps":[],"jobName":"paragraph_1524487461831_-794682937","id":"20170320-124619_794351413","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:44:41+0000","dateFinished":"2018-04-24T16:44:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:207"},{"title":"Print Versions","text":"%pyspark\nimport sys\nprint(\"Spark Version:  \"+str(spark.version))\nprint(\"Python Version: \"+str(sys.version))\n","user":"admin","dateUpdated":"2018-04-24T16:44:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spark Version:  2.1.1.2.6.2.14-5\nPython Version: 2.7.14 |Anaconda, Inc.| (default, Oct 16 2017, 17:29:19) \n[GCC 7.2.0]\n"}]},"apps":[],"jobName":"paragraph_1524487477723_1695057844","id":"20180423-124437_961456404","dateCreated":"2018-04-23T12:44:37+0000","dateStarted":"2018-04-24T16:44:41+0000","dateFinished":"2018-04-24T16:44:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208"},{"title":"Download and Load Data into HDFS","text":"%sh\n\n# Download Data from Github\nwget https://raw.githubusercontent.com/hortonworks/data-tutorials/master/tutorials/hdp/predicting-airline-delays-using-sparkr/assets/airline_data.zip\n\n# Unzip\nunzip airline_data.zip\n\n# Make HDFS Directory and Load CSV files into HDFS\nhadoop fs -mkdir /tmp/airline_delays\nhadoop fs -put ./airline_data/train_df.csv /tmp/airline_delays/.\nhadoop fs -put ./airline_data/test_df.csv /tmp/airline_delays/.\n\nhadoop fs -ls /tmp/airline_delays","user":"admin","dateUpdated":"2018-04-24T13:21:42+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh","title":true,"tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2018-04-23 22:15:39--  https://raw.githubusercontent.com/hortonworks/data-tutorials/master/tutorials/hdp/predicting-airline-delays-using-sparkr/assets/airline_data.zip\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.192.133, 151.101.0.133, 151.101.64.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.192.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 25613885 (24M) [application/zip]\nSaving to: ‘airline_data.zip’\n\n     0K .......... .......... .......... .......... ..........  0% 34.6M 1s\n    50K .......... .......... .......... .......... ..........  0% 69.2M 1s\n   100K .......... .......... .......... .......... ..........  0% 40.0M 1s\n   150K .......... .......... .......... .......... ..........  0% 44.9M 1s\n   200K .......... .......... .......... .......... ..........  0% 38.7M 1s\n   250K .......... .......... .......... .......... ..........  1% 58.4M 1s\n   300K .......... .......... .......... .......... ..........  1% 46.4M 1s\n   350K .......... .......... .......... .......... ..........  1% 50.9M 1s\n   400K .......... .......... .......... .......... ..........  1% 29.4M 1s\n   450K .......... .......... .......... .......... ..........  1% 60.9M 1s\n   500K .......... .......... .......... .......... ..........  2% 36.3M 1s\n   550K .......... .......... .......... .......... ..........  2% 50.9M 1s\n   600K .......... .......... .......... .......... ..........  2% 53.5M 1s\n   650K .......... .......... .......... .......... ..........  2% 69.7M 1s\n   700K .......... .......... .......... .......... ..........  2% 55.2M 1s\n   750K .......... .......... .......... .......... ..........  3% 56.5M 1s\n   800K .......... .......... .......... .......... ..........  3% 67.0M 0s\n   850K .......... .......... .......... .......... ..........  3% 87.7M 0s\n   900K .......... .......... .......... .......... ..........  3% 79.1M 0s\n   950K .......... .......... .......... .......... ..........  3% 66.0M 0s\n  1000K .......... .......... .......... .......... ..........  4% 67.2M 0s\n  1050K .......... .......... .......... .......... ..........  4% 73.8M 0s\n  1100K .......... .......... .......... .......... ..........  4% 69.1M 0s\n  1150K .......... .......... .......... .......... ..........  4% 80.7M 0s\n  1200K .......... .......... .......... .......... ..........  4% 42.8M 0s\n  1250K .......... .......... .......... .......... ..........  5% 88.6M 0s\n  1300K .......... .......... .......... .......... ..........  5%  117M 0s\n  1350K .......... .......... .......... .......... ..........  5%  116M 0s\n  1400K .......... .......... .......... .......... ..........  5%  113M 0s\n  1450K .......... .......... .......... .......... ..........  5%  115M 0s\n  1500K .......... .......... .......... .......... ..........  6%  120M 0s\n  1550K .......... .......... .......... .......... ..........  6%  112M 0s\n  1600K .......... .......... .......... .......... ..........  6% 99.7M 0s\n  1650K .......... .......... .......... .......... ..........  6%  120M 0s\n  1700K .......... .......... .......... .......... ..........  6%  118M 0s\n  1750K .......... .......... .......... .......... ..........  7%  143M 0s\n  1800K .......... .......... .......... .......... ..........  7% 97.1M 0s\n  1850K .......... .......... .......... .......... ..........  7%  126M 0s\n  1900K .......... .......... .......... .......... ..........  7%  130M 0s\n  1950K .......... .......... .......... .......... ..........  7%  144M 0s\n  2000K .......... .......... .......... .......... ..........  8%  107M 0s\n  2050K .......... .......... .......... .......... ..........  8%  116M 0s\n  2100K .......... .......... .......... .......... ..........  8%  145M 0s\n  2150K .......... .......... .......... .......... ..........  8%  117M 0s\n  2200K .......... .......... .......... .......... ..........  8% 95.4M 0s\n  2250K .......... .......... .......... .......... ..........  9%  127M 0s\n  2300K .......... .......... .......... .......... ..........  9%  113M 0s\n  2350K .......... .......... .......... .......... ..........  9% 54.3M 0s\n  2400K .......... .......... .......... .......... ..........  9%  132M 0s\n  2450K .......... .......... .......... .......... ..........  9%  145M 0s\n  2500K .......... .......... .......... .......... .......... 10%  146M 0s\n  2550K .......... .......... .......... .......... .......... 10%  145M 0s\n  2600K .......... .......... .......... .......... .......... 10%  122M 0s\n  2650K .......... .......... .......... .......... .......... 10%  112M 0s\n  2700K .......... .......... .......... .......... .......... 10%  158M 0s\n  2750K .......... .......... .......... .......... .......... 11%  125M 0s\n  2800K .......... .......... .......... .......... .......... 11%  119M 0s\n  2850K .......... .......... .......... .......... .......... 11%  124M 0s\n  2900K .......... .......... .......... .......... .......... 11%  124M 0s\n  2950K .......... .......... .......... .......... .......... 11%  149M 0s\n  3000K .......... .......... .......... .......... .......... 12%  110M 0s\n  3050K .......... .......... .......... .......... .......... 12%  125M 0s\n  3100K .......... .......... .......... .......... .......... 12%  148M 0s\n  3150K .......... .......... .......... .......... .......... 12%  114M 0s\n  3200K .......... .......... .......... .......... .......... 12%  103M 0s\n  3250K .......... .......... .......... .......... .......... 13%  118M 0s\n  3300K .......... .......... .......... .......... .......... 13%  133M 0s\n  3350K .......... .......... .......... .......... .......... 13%  141M 0s\n  3400K .......... .......... .......... .......... .......... 13%  117M 0s\n  3450K .......... .......... .......... .......... .......... 13%  170M 0s\n  3500K .......... .......... .......... .......... .......... 14%  149M 0s\n  3550K .......... .......... .......... .......... .......... 14%  111M 0s\n  3600K .......... .......... .......... .......... .......... 14%  104M 0s\n  3650K .......... .......... .......... .......... .......... 14%  110M 0s\n  3700K .......... .......... .......... .......... .......... 14%  133M 0s\n  3750K .......... .......... .......... .......... .......... 15%  130M 0s\n  3800K .......... .......... .......... .......... .......... 15%  123M 0s\n  3850K .......... .......... .......... .......... .......... 15%  141M 0s\n  3900K .......... .......... .......... .......... .......... 15%  120M 0s\n  3950K .......... .......... .......... .......... .......... 15%  122M 0s\n  4000K .......... .......... .......... .......... .......... 16% 95.5M 0s\n  4050K .......... .......... .......... .......... .......... 16%  156M 0s\n  4100K .......... .......... .......... .......... .......... 16%  137M 0s\n  4150K .......... .......... .......... .......... .......... 16%  131M 0s\n  4200K .......... .......... .......... .......... .......... 16%  127M 0s\n  4250K .......... .......... .......... .......... .......... 17%  155M 0s\n  4300K .......... .......... .......... .......... .......... 17%  122M 0s\n  4350K .......... .......... .......... .......... .......... 17%  127M 0s\n  4400K .......... .......... .......... .......... .......... 17%  107M 0s\n  4450K .......... .......... .......... .......... .......... 17%  141M 0s\n  4500K .......... .......... .......... .......... .......... 18%  174M 0s\n  4550K .......... .......... .......... .......... .......... 18%  143M 0s\n  4600K .......... .......... .......... .......... .......... 18%  126M 0s\n  4650K .......... .......... .......... .......... .......... 18%  150M 0s\n  4700K .......... .......... .......... .......... .......... 18%  135M 0s\n  4750K .......... .......... .......... .......... .......... 19%  146M 0s\n  4800K .......... .......... .......... .......... .......... 19%  109M 0s\n  4850K .......... .......... .......... .......... .......... 19%  143M 0s\n  4900K .......... .......... .......... .......... .......... 19%  145M 0s\n  4950K .......... .......... .......... .......... .......... 19%  145M 0s\n  5000K .......... .......... .......... .......... .......... 20%  105M 0s\n  5050K .......... .......... .......... .......... .......... 20%  134M 0s\n  5100K .......... .......... .......... .......... .......... 20%  132M 0s\n  5150K .......... .......... .......... .......... .......... 20%  150M 0s\n  5200K .......... .......... .......... .......... .......... 20%  128M 0s\n  5250K .......... .......... .......... .......... .......... 21%  129M 0s\n  5300K .......... .......... .......... .......... .......... 21%  143M 0s\n  5350K .......... .......... .......... .......... .......... 21%  126M 0s\n  5400K .......... .......... .......... .......... .......... 21%  138M 0s\n  5450K .......... .......... .......... .......... .......... 21%  155M 0s\n  5500K .......... .......... .......... .......... .......... 22%  148M 0s\n  5550K .......... .......... .......... .......... .......... 22%  145M 0s\n  5600K .......... .......... .......... .......... .......... 22%  130M 0s\n  5650K .......... .......... .......... .......... .......... 22%  174M 0s\n  5700K .......... .......... .......... .......... .......... 22%  130M 0s\n  5750K .......... .......... .......... .......... .......... 23%  161M 0s\n  5800K .......... .......... .......... .......... .......... 23%  152M 0s\n  5850K .......... .......... .......... .......... .......... 23%  123M 0s\n  5900K .......... .......... .......... .......... .......... 23%  155M 0s\n  5950K .......... .......... .......... .......... .......... 23%  139M 0s\n  6000K .......... .......... .......... .......... .......... 24%  122M 0s\n  6050K .......... .......... .......... .......... .......... 24%  161M 0s\n  6100K .......... .......... .......... .......... .......... 24%  124M 0s\n  6150K .......... .......... .......... .......... .......... 24%  137M 0s\n  6200K .......... .......... .......... .......... .......... 24%  130M 0s\n  6250K .......... .......... .......... .......... .......... 25%  122M 0s\n  6300K .......... .......... .......... .......... .......... 25%  126M 0s\n  6350K .......... .......... .......... .......... .......... 25%  130M 0s\n  6400K .......... .......... .......... .......... .......... 25% 97.3M 0s\n  6450K .......... .......... .......... .......... .......... 25%  146M 0s\n  6500K .......... .......... .......... .......... .......... 26% 36.4M 0s\n  6550K .......... .......... .......... .......... .......... 26%  104M 0s\n  6600K .......... .......... .......... .......... .......... 26% 96.6M 0s\n  6650K .......... .......... .......... .......... .......... 26% 69.8M 0s\n  6700K .......... .......... .......... .......... .......... 26% 53.0M 0s\n  6750K .......... .......... .......... .......... .......... 27% 92.3M 0s\n  6800K .......... .......... .......... .......... .......... 27% 77.0M 0s\n  6850K .......... .......... .......... .......... .......... 27%  125M 0s\n  6900K .......... .......... .......... .......... .......... 27%  132M 0s\n  6950K .......... .......... .......... .......... .......... 27%  123M 0s\n  7000K .......... .......... .......... .......... .......... 28%  121M 0s\n  7050K .......... .......... .......... .......... .......... 28%  107M 0s\n  7100K .......... .......... .......... .......... .......... 28% 79.6M 0s\n  7150K .......... .......... .......... .......... .......... 28% 86.1M 0s\n  7200K .......... .......... .......... .......... .......... 28% 93.5M 0s\n  7250K .......... .......... .......... .......... .......... 29%  103M 0s\n  7300K .......... .......... .......... .......... .......... 29%  106M 0s\n  7350K .......... .......... .......... .......... .......... 29%  129M 0s\n  7400K .......... .......... .......... .......... .......... 29% 95.1M 0s\n  7450K .......... .......... .......... .......... .......... 29%  122M 0s\n  7500K .......... .......... .......... .......... .......... 30% 86.3M 0s\n  7550K .......... .......... .......... .......... .......... 30%  104M 0s\n  7600K .......... .......... .......... .......... .......... 30% 76.9M 0s\n  7650K .......... .......... .......... .......... .......... 30% 95.6M 0s\n  7700K .......... .......... .......... .......... .......... 30%  114M 0s\n  7750K .......... .......... .......... .......... .......... 31%  107M 0s\n  7800K .......... .......... .......... .......... .......... 31% 90.9M 0s\n  7850K .......... .......... .......... .......... .......... 31%  102M 0s\n  7900K .......... .......... .......... .......... .......... 31% 87.9M 0s\n  7950K .......... .......... .......... .......... .......... 31% 90.1M 0s\n  8000K .......... .......... .......... .......... .......... 32% 86.5M 0s\n  8050K .......... .......... .......... .......... .......... 32% 97.7M 0s\n  8100K .......... .......... .......... .......... .......... 32% 99.7M 0s\n  8150K .......... .......... .......... .......... .......... 32%  102M 0s\n  8200K .......... .......... .......... .......... .......... 32% 82.8M 0s\n  8250K .......... .......... .......... .......... .......... 33% 65.7M 0s\n  8300K .......... .......... .......... .......... .......... 33%  104M 0s\n  8350K .......... .......... .......... .......... .......... 33%  104M 0s\n  8400K .......... .......... .......... .......... .......... 33% 82.5M 0s\n  8450K .......... .......... .......... .......... .......... 33% 97.8M 0s\n  8500K .......... .......... .......... .......... .......... 34%  119M 0s\n  8550K .......... .......... .......... .......... .......... 34%  104M 0s\n  8600K .......... .......... .......... .......... .......... 34% 87.6M 0s\n  8650K .......... .......... .......... .......... .......... 34% 95.5M 0s\n  8700K .......... .......... .......... .......... .......... 34%  104M 0s\n  8750K .......... .......... .......... .......... .......... 35%  118M 0s\n  8800K .......... .......... .......... .......... .......... 35% 99.0M 0s\n  8850K .......... .......... .......... .......... .......... 35%  110M 0s\n  8900K .......... .......... .......... .......... .......... 35% 98.0M 0s\n  8950K .......... .......... .......... .......... .......... 35%  124M 0s\n  9000K .......... .......... .......... .......... .......... 36% 98.2M 0s\n  9050K .......... .......... .......... .......... .......... 36%  107M 0s\n  9100K .......... .......... .......... .......... .......... 36%  105M 0s\n  9150K .......... .......... .......... .......... .......... 36%  116M 0s\n  9200K .......... .......... .......... .......... .......... 36% 84.1M 0s\n  9250K .......... .......... .......... .......... .......... 37%  104M 0s\n  9300K .......... .......... .......... .......... .......... 37%  103M 0s\n  9350K .......... .......... .......... .......... .......... 37%  107M 0s\n  9400K .......... .......... .......... .......... .......... 37% 96.7M 0s\n  9450K .......... .......... .......... .......... .......... 37%  102M 0s\n  9500K .......... .......... .......... .......... .......... 38%  134M 0s\n  9550K .......... .......... .......... .......... .......... 38%  110M 0s\n  9600K .......... .......... .......... .......... .......... 38%  100M 0s\n  9650K .......... .......... .......... .......... .......... 38%  133M 0s\n  9700K .......... .......... .......... .......... .......... 38%  124M 0s\n  9750K .......... .......... .......... .......... .......... 39%  119M 0s\n  9800K .......... .......... .......... .......... .......... 39% 94.5M 0s\n  9850K .......... .......... .......... .......... .......... 39%  107M 0s\n  9900K .......... .......... .......... .......... .......... 39% 94.6M 0s\n  9950K .......... .......... .......... .......... .......... 39%  113M 0s\n 10000K .......... .......... .......... .......... .......... 40%  103M 0s\n 10050K .......... .......... .......... .......... .......... 40%  101M 0s\n 10100K .......... .......... .......... .......... .......... 40%  108M 0s\n 10150K .......... .......... .......... .......... .......... 40% 94.7M 0s\n 10200K .......... .......... .......... .......... .......... 40% 98.5M 0s\n 10250K .......... .......... .......... .......... .......... 41% 95.8M 0s\n 10300K .......... .......... .......... .......... .......... 41%  107M 0s\n 10350K .......... .......... .......... .......... .......... 41%  101M 0s\n 10400K .......... .......... .......... .......... .......... 41% 84.5M 0s\n 10450K .......... .......... .......... .......... .......... 41% 95.5M 0s\n 10500K .......... .......... .......... .......... .......... 42%  114M 0s\n 10550K .......... .......... .......... .......... .......... 42% 98.8M 0s\n 10600K .......... .......... .......... .......... .......... 42% 88.4M 0s\n 10650K .......... .......... .......... .......... .......... 42% 84.6M 0s\n 10700K .......... .......... .......... .......... .......... 42%  118M 0s\n 10750K .......... .......... .......... .......... .......... 43%  110M 0s\n 10800K .......... .......... .......... .......... .......... 43% 90.5M 0s\n 10850K .......... .......... .......... .......... .......... 43%  100M 0s\n 10900K .......... .......... .......... .......... .......... 43%  107M 0s\n 10950K .......... .......... .......... .......... .......... 43%  100M 0s\n 11000K .......... .......... .......... .......... .......... 44% 88.7M 0s\n 11050K .......... .......... .......... .......... .......... 44%  104M 0s\n 11100K .......... .......... .......... .......... .......... 44% 99.6M 0s\n 11150K .......... .......... .......... .......... .......... 44%  115M 0s\n 11200K .......... .......... .......... .......... .......... 44% 95.6M 0s\n 11250K .......... .......... .......... .......... .......... 45%  111M 0s\n 11300K .......... .......... .......... .......... .......... 45%  113M 0s\n 11350K .......... .......... .......... .......... .......... 45% 55.3M 0s\n 11400K .......... .......... .......... .......... .......... 45% 97.6M 0s\n 11450K .......... .......... .......... .......... .......... 45%  109M 0s\n 11500K .......... .......... .......... .......... .......... 46%  124M 0s\n 11550K .......... .......... .......... .......... .......... 46% 94.2M 0s\n 11600K .......... .......... .......... .......... .......... 46%  100M 0s\n 11650K .......... .......... .......... .......... .......... 46%  103M 0s\n 11700K .......... .......... .......... .......... .......... 46%  124M 0s\n 11750K .......... .......... .......... .......... .......... 47% 10.3M 0s\n 11800K .......... .......... .......... .......... .......... 47% 80.5M 0s\n 11850K .......... .......... .......... .......... .......... 47%  108M 0s\n 11900K .......... .......... .......... .......... .......... 47% 83.3M 0s\n 11950K .......... .......... .......... .......... .......... 47% 73.7M 0s\n 12000K .......... .......... .......... .......... .......... 48% 69.2M 0s\n 12050K .......... .......... .......... .......... .......... 48% 72.6M 0s\n 12100K .......... .......... .......... .......... .......... 48% 71.0M 0s\n 12150K .......... .......... .......... .......... .......... 48% 63.1M 0s\n 12200K .......... .......... .......... .......... .......... 48% 57.2M 0s\n 12250K .......... .......... .......... .......... .......... 49% 88.4M 0s\n 12300K .......... .......... .......... .......... .......... 49% 75.6M 0s\n 12350K .......... .......... .......... .......... .......... 49% 85.1M 0s\n 12400K .......... .......... .......... .......... .......... 49% 49.3M 0s\n 12450K .......... .......... .......... .......... .......... 49% 73.1M 0s\n 12500K .......... .......... .......... .......... .......... 50% 82.1M 0s\n 12550K .......... .......... .......... .......... .......... 50%  129M 0s\n 12600K .......... .......... .......... .......... .......... 50%  102M 0s\n 12650K .......... .......... .......... .......... .......... 50%  136M 0s\n 12700K .......... .......... .......... .......... .......... 50%  127M 0s\n 12750K .......... .......... .......... .......... .......... 51%  103M 0s\n 12800K .......... .......... .......... .......... .......... 51% 45.1M 0s\n 12850K .......... .......... .......... .......... .......... 51% 80.9M 0s\n 12900K .......... .......... .......... .......... .......... 51%  111M 0s\n 12950K .......... .......... .......... .......... .......... 51% 81.9M 0s\n 13000K .......... .......... .......... .......... .......... 52% 98.4M 0s\n 13050K .......... .......... .......... .......... .......... 52% 85.4M 0s\n 13100K .......... .......... .......... .......... .......... 52%  107M 0s\n 13150K .......... .......... .......... .......... .......... 52%  101M 0s\n 13200K .......... .......... .......... .......... .......... 52% 92.4M 0s\n 13250K .......... .......... .......... .......... .......... 53%  104M 0s\n 13300K .......... .......... .......... .......... .......... 53% 89.0M 0s\n 13350K .......... .......... .......... .......... .......... 53% 90.6M 0s\n 13400K .......... .......... .......... .......... .......... 53% 80.5M 0s\n 13450K .......... .......... .......... .......... .......... 53% 72.1M 0s\n 13500K .......... .......... .......... .......... .......... 54% 79.3M 0s\n 13550K .......... .......... .......... .......... .......... 54% 83.7M 0s\n 13600K .......... .......... .......... .......... .......... 54% 59.5M 0s\n 13650K .......... .......... .......... .......... .......... 54%  110M 0s\n 13700K .......... .......... .......... .......... .......... 54% 51.3M 0s\n 13750K .......... .......... .......... .......... .......... 55%  100M 0s\n 13800K .......... .......... .......... .......... .......... 55% 88.5M 0s\n 13850K .......... .......... .......... .......... .......... 55% 87.4M 0s\n 13900K .......... .......... .......... .......... .......... 55% 83.4M 0s\n 13950K .......... .......... .......... .......... .......... 55% 98.1M 0s\n 14000K .......... .......... .......... .......... .......... 56% 85.9M 0s\n 14050K .......... .......... .......... .......... .......... 56%  106M 0s\n 14100K .......... .......... .......... .......... .......... 56% 88.5M 0s\n 14150K .......... .......... .......... .......... .......... 56% 56.3M 0s\n 14200K .......... .......... .......... .......... .......... 56% 85.1M 0s\n 14250K .......... .......... .......... .......... .......... 57% 84.7M 0s\n 14300K .......... .......... .......... .......... .......... 57% 89.1M 0s\n 14350K .......... .......... .......... .......... .......... 57% 96.7M 0s\n 14400K .......... .......... .......... .......... .......... 57% 78.4M 0s\n 14450K .......... .......... .......... .......... .......... 57% 86.2M 0s\n 14500K .......... .......... .......... .......... .......... 58% 96.1M 0s\n 14550K .......... .......... .......... .......... .......... 58% 68.2M 0s\n 14600K .......... .......... .......... .......... .......... 58% 75.8M 0s\n 14650K .......... .......... .......... .......... .......... 58% 93.4M 0s\n 14700K .......... .......... .......... .......... .......... 58% 74.3M 0s\n 14750K .......... .......... .......... .......... .......... 59% 76.9M 0s\n 14800K .......... .......... .......... .......... .......... 59% 84.0M 0s\n 14850K .......... .......... .......... .......... .......... 59% 57.7M 0s\n 14900K .......... .......... .......... .......... .......... 59%  105M 0s\n 14950K .......... .......... .......... .......... .......... 59% 92.7M 0s\n 15000K .......... .......... .......... .......... .......... 60% 69.5M 0s\n 15050K .......... .......... .......... .......... .......... 60% 51.8M 0s\n 15100K .......... .......... .......... .......... .......... 60%  106M 0s\n 15150K .......... .......... .......... .......... .......... 60% 95.2M 0s\n 15200K .......... .......... .......... .......... .......... 60% 89.3M 0s\n 15250K .......... .......... .......... .......... .......... 61% 98.1M 0s\n 15300K .......... .......... .......... .......... .......... 61% 98.5M 0s\n 15350K .......... .......... .......... .......... .......... 61% 93.4M 0s\n 15400K .......... .......... .......... .......... .......... 61% 96.1M 0s\n 15450K .......... .......... .......... .......... .......... 61% 92.0M 0s\n 15500K .......... .......... .......... .......... .......... 62% 78.7M 0s\n 15550K .......... .......... .......... .......... .......... 62% 69.2M 0s\n 15600K .......... .......... .......... .......... .......... 62% 69.9M 0s\n 15650K .......... .......... .......... .......... .......... 62% 86.0M 0s\n 15700K .......... .......... .......... .......... .......... 62% 73.3M 0s\n 15750K .......... .......... .......... .......... .......... 63% 80.7M 0s\n 15800K .......... .......... .......... .......... .......... 63% 79.9M 0s\n 15850K .......... .......... .......... .......... .......... 63% 76.9M 0s\n 15900K .......... .......... .......... .......... .......... 63% 99.2M 0s\n 15950K .......... .......... .......... .......... .......... 63% 92.6M 0s\n 16000K .......... .......... .......... .......... .......... 64% 85.6M 0s\n 16050K .......... .......... .......... .......... .......... 64% 91.9M 0s\n 16100K .......... .......... .......... .......... .......... 64% 98.0M 0s\n 16150K .......... .......... .......... .......... .......... 64%  109M 0s\n 16200K .......... .......... .......... .......... .......... 64% 87.0M 0s\n 16250K .......... .......... .......... .......... .......... 65% 96.7M 0s\n 16300K .......... .......... .......... .......... .......... 65% 98.3M 0s\n 16350K .......... .......... .......... .......... .......... 65% 78.2M 0s\n 16400K .......... .......... .......... .......... .......... 65% 74.4M 0s\n 16450K .......... .......... .......... .......... .......... 65% 96.4M 0s\n 16500K .......... .......... .......... .......... .......... 66% 98.7M 0s\n 16550K .......... .......... .......... .......... .......... 66% 94.9M 0s\n 16600K .......... .......... .......... .......... .......... 66% 82.7M 0s\n 16650K .......... .......... .......... .......... .......... 66%  104M 0s\n 16700K .......... .......... .......... .......... .......... 66% 94.6M 0s\n 16750K .......... .......... .......... .......... .......... 67%  101M 0s\n 16800K .......... .......... .......... .......... .......... 67% 70.3M 0s\n 16850K .......... .......... .......... .......... .......... 67% 99.6M 0s\n 16900K .......... .......... .......... .......... .......... 67% 96.3M 0s\n 16950K .......... .......... .......... .......... .......... 67% 97.5M 0s\n 17000K .......... .......... .......... .......... .......... 68% 91.9M 0s\n 17050K .......... .......... .......... .......... .......... 68% 98.1M 0s\n 17100K .......... .......... .......... .......... .......... 68%  105M 0s\n 17150K .......... .......... .......... .......... .......... 68%  108M 0s\n 17200K .......... .......... .......... .......... .......... 68% 80.2M 0s\n 17250K .......... .......... .......... .......... .......... 69% 99.2M 0s\n 17300K .......... .......... .......... .......... .......... 69%  115M 0s\n 17350K .......... .......... .......... .......... .......... 69% 92.9M 0s\n 17400K .......... .......... .......... .......... .......... 69% 78.2M 0s\n 17450K .......... .......... .......... .......... .......... 69% 89.5M 0s\n 17500K .......... .......... .......... .......... .......... 70%  110M 0s\n 17550K .......... .......... .......... .......... .......... 70% 91.4M 0s\n 17600K .......... .......... .......... .......... .......... 70% 94.4M 0s\n 17650K .......... .......... .......... .......... .......... 70% 91.0M 0s\n 17700K .......... .......... .......... .......... .......... 70%  113M 0s\n 17750K .......... .......... .......... .......... .......... 71% 97.0M 0s\n 17800K .......... .......... .......... .......... .......... 71% 85.4M 0s\n 17850K .......... .......... .......... .......... .......... 71% 83.7M 0s\n 17900K .......... .......... .......... .......... .......... 71% 91.8M 0s\n 17950K .......... .......... .......... .......... .......... 71% 92.1M 0s\n 18000K .......... .......... .......... .......... .......... 72% 90.9M 0s\n 18050K .......... .......... .......... .......... .......... 72% 97.0M 0s\n 18100K .......... .......... .......... .......... .......... 72%  112M 0s\n 18150K .......... .......... .......... .......... .......... 72% 90.1M 0s\n 18200K .......... .......... .......... .......... .......... 72% 91.6M 0s\n 18250K .......... .......... .......... .......... .......... 73%  109M 0s\n 18300K .......... .......... .......... .......... .......... 73%  105M 0s\n 18350K .......... .......... .......... .......... .......... 73%  107M 0s\n 18400K .......... .......... .......... .......... .......... 73% 68.3M 0s\n 18450K .......... .......... .......... .......... .......... 73% 83.7M 0s\n 18500K .......... .......... .......... .......... .......... 74% 80.9M 0s\n 18550K .......... .......... .......... .......... .......... 74%  107M 0s\n 18600K .......... .......... .......... .......... .......... 74% 84.9M 0s\n 18650K .......... .......... .......... .......... .......... 74% 99.2M 0s\n 18700K .......... .......... .......... .......... .......... 74% 76.5M 0s\n 18750K .......... .......... .......... .......... .......... 75%  107M 0s\n 18800K .......... .......... .......... .......... .......... 75% 91.0M 0s\n 18850K .......... .......... .......... .......... .......... 75%  122M 0s\n 18900K .......... .......... .......... .......... .......... 75% 90.2M 0s\n 18950K .......... .......... .......... .......... .......... 75%  106M 0s\n 19000K .......... .......... .......... .......... .......... 76% 80.7M 0s\n 19050K .......... .......... .......... .......... .......... 76%  108M 0s\n 19100K .......... .......... .......... .......... .......... 76%  101M 0s\n 19150K .......... .......... .......... .......... .......... 76% 76.8M 0s\n 19200K .......... .......... .......... .......... .......... 76% 76.7M 0s\n 19250K .......... .......... .......... .......... .......... 77% 99.0M 0s\n 19300K .......... .......... .......... .......... .......... 77%  100M 0s\n 19350K .......... .......... .......... .......... .......... 77% 69.6M 0s\n 19400K .......... .......... .......... .......... .......... 77% 88.2M 0s\n 19450K .......... .......... .......... .......... .......... 77% 92.6M 0s\n 19500K .......... .......... .......... .......... .......... 78%  120M 0s\n 19550K .......... .......... .......... .......... .......... 78% 78.1M 0s\n 19600K .......... .......... .......... .......... .......... 78% 40.6M 0s\n 19650K .......... .......... .......... .......... .......... 78% 94.7M 0s\n 19700K .......... .......... .......... .......... .......... 78% 94.9M 0s\n 19750K .......... .......... .......... .......... .......... 79%  101M 0s\n 19800K .......... .......... .......... .......... .......... 79% 89.5M 0s\n 19850K .......... .......... .......... .......... .......... 79% 89.2M 0s\n 19900K .......... .......... .......... .......... .......... 79%  111M 0s\n 19950K .......... .......... .......... .......... .......... 79%  105M 0s\n 20000K .......... .......... .......... .......... .......... 80% 90.8M 0s\n 20050K .......... .......... .......... .......... .......... 80%  108M 0s\n 20100K .......... .......... .......... .......... .......... 80%  104M 0s\n 20150K .......... .......... .......... .......... .......... 80%  101M 0s\n 20200K .......... .......... .......... .......... .......... 80% 93.9M 0s\n 20250K .......... .......... .......... .......... .......... 81% 78.0M 0s\n 20300K .......... .......... .......... .......... .......... 81% 93.5M 0s\n 20350K .......... .......... .......... .......... .......... 81%  109M 0s\n 20400K .......... .......... .......... .......... .......... 81% 64.0M 0s\n 20450K .......... .......... .......... .......... .......... 81% 75.0M 0s\n 20500K .......... .......... .......... .......... .......... 82% 68.8M 0s\n 20550K .......... .......... .......... .......... .......... 82% 87.3M 0s\n 20600K .......... .......... .......... .......... .......... 82% 86.3M 0s\n 20650K .......... .......... .......... .......... .......... 82% 88.2M 0s\n 20700K .......... .......... .......... .......... .......... 82% 82.2M 0s\n 20750K .......... .......... .......... .......... .......... 83% 98.8M 0s\n 20800K .......... .......... .......... .......... .......... 83% 70.5M 0s\n 20850K .......... .......... .......... .......... .......... 83%  102M 0s\n 20900K .......... .......... .......... .......... .......... 83% 96.7M 0s\n 20950K .......... .......... .......... .......... .......... 83% 85.2M 0s\n 21000K .......... .......... .......... .......... .......... 84% 68.7M 0s\n 21050K .......... .......... .......... .......... .......... 84% 75.7M 0s\n 21100K .......... .......... .......... .......... .......... 84% 92.7M 0s\n 21150K .......... .......... .......... .......... .......... 84% 84.3M 0s\n 21200K .......... .......... .......... .......... .......... 84% 76.5M 0s\n 21250K .......... .......... .......... .......... .......... 85%  105M 0s\n 21300K .......... .......... .......... .......... .......... 85% 52.5M 0s\n 21350K .......... .......... .......... .......... .......... 85%  102M 0s\n 21400K .......... .......... .......... .......... .......... 85% 44.4M 0s\n 21450K .......... .......... .......... .......... .......... 85% 88.3M 0s\n 21500K .......... .......... .......... .......... .......... 86% 90.4M 0s\n 21550K .......... .......... .......... .......... .......... 86% 80.8M 0s\n 21600K .......... .......... .......... .......... .......... 86% 78.4M 0s\n 21650K .......... .......... .......... .......... .......... 86% 60.7M 0s\n 21700K .......... .......... .......... .......... .......... 86%  110M 0s\n 21750K .......... .......... .......... .......... .......... 87% 94.2M 0s\n 21800K .......... .......... .......... .......... .......... 87% 85.7M 0s\n 21850K .......... .......... .......... .......... .......... 87%  106M 0s\n 21900K .......... .......... .......... .......... .......... 87% 88.5M 0s\n 21950K .......... .......... .......... .......... .......... 87% 92.3M 0s\n 22000K .......... .......... .......... .......... .......... 88% 83.2M 0s\n 22050K .......... .......... .......... .......... .......... 88% 88.5M 0s\n 22100K .......... .......... .......... .......... .......... 88%  114M 0s\n 22150K .......... .......... .......... .......... .......... 88%  123M 0s\n 22200K .......... .......... .......... .......... .......... 88%  104M 0s\n 22250K .......... .......... .......... .......... .......... 89% 82.5M 0s\n 22300K .......... .......... .......... .......... .......... 89% 97.0M 0s\n 22350K .......... .......... .......... .......... .......... 89% 80.8M 0s\n 22400K .......... .......... .......... .......... .......... 89% 83.7M 0s\n 22450K .......... .......... .......... .......... .......... 89%  119M 0s\n 22500K .......... .......... .......... .......... .......... 90%  101M 0s\n 22550K .......... .......... .......... .......... .......... 90% 80.0M 0s\n 22600K .......... .......... .......... .......... .......... 90% 87.8M 0s\n 22650K .......... .......... .......... .......... .......... 90% 82.8M 0s\n 22700K .......... .......... .......... .......... .......... 90% 94.4M 0s\n 22750K .......... .......... .......... .......... .......... 91%  102M 0s\n 22800K .......... .......... .......... .......... .......... 91% 83.4M 0s\n 22850K .......... .......... .......... .......... .......... 91% 96.2M 0s\n 22900K .......... .......... .......... .......... .......... 91% 86.4M 0s\n 22950K .......... .......... .......... .......... .......... 91% 95.1M 0s\n 23000K .......... .......... .......... .......... .......... 92%  106M 0s\n 23050K .......... .......... .......... .......... .......... 92%  113M 0s\n 23100K .......... .......... .......... .......... .......... 92%  107M 0s\n 23150K .......... .......... .......... .......... .......... 92%  116M 0s\n 23200K .......... .......... .......... .......... .......... 92% 80.1M 0s\n 23250K .......... .......... .......... .......... .......... 93% 98.3M 0s\n 23300K .......... .......... .......... .......... .......... 93% 89.2M 0s\n 23350K .......... .......... .......... .......... .......... 93%  115M 0s\n 23400K .......... .......... .......... .......... .......... 93% 93.4M 0s\n 23450K .......... .......... .......... .......... .......... 93% 97.1M 0s\n 23500K .......... .......... .......... .......... .......... 94% 92.8M 0s\n 23550K .......... .......... .......... .......... .......... 94% 95.2M 0s\n 23600K .......... .......... .......... .......... .......... 94% 94.5M 0s\n 23650K .......... .......... .......... .......... .......... 94% 82.3M 0s\n 23700K .......... .......... .......... .......... .......... 94% 86.5M 0s\n 23750K .......... .......... .......... .......... .......... 95% 96.2M 0s\n 23800K .......... .......... .......... .......... .......... 95% 95.4M 0s\n 23850K .......... .......... .......... .......... .......... 95%  102M 0s\n 23900K .......... .......... .......... .......... .......... 95% 85.7M 0s\n 23950K .......... .......... .......... .......... .......... 95%  105M 0s\n 24000K .......... .......... .......... .......... .......... 96% 93.9M 0s\n 24050K .......... .......... .......... .......... .......... 96% 60.0M 0s\n 24100K .......... .......... .......... .......... .......... 96%  116M 0s\n 24150K .......... .......... .......... .......... .......... 96%  117M 0s\n 24200K .......... .......... .......... .......... .......... 96%  105M 0s\n 24250K .......... .......... .......... .......... .......... 97%  109M 0s\n 24300K .......... .......... .......... .......... .......... 97%  131M 0s\n 24350K .......... .......... .......... .......... .......... 97%  110M 0s\n 24400K .......... .......... .......... .......... .......... 97%  106M 0s\n 24450K .......... .......... .......... .......... .......... 97%  115M 0s\n 24500K .......... .......... .......... .......... .......... 98% 98.2M 0s\n 24550K .......... .......... .......... .......... .......... 98%  124M 0s\n 24600K .......... .......... .......... .......... .......... 98% 90.3M 0s\n 24650K .......... .......... .......... .......... .......... 98%  125M 0s\n 24700K .......... .......... .......... .......... .......... 98% 88.8M 0s\n 24750K .......... .......... .......... .......... .......... 99%  115M 0s\n 24800K .......... .......... .......... .......... .......... 99% 85.5M 0s\n 24850K .......... .......... .......... .......... .......... 99%  117M 0s\n 24900K .......... .......... .......... .......... .......... 99%  101M 0s\n 24950K .......... .......... .......... .......... .......... 99%  102M 0s\n 25000K .......... ...                                        100% 86.0M=0.3s\n\n2018-04-23 22:15:39 (91.1 MB/s) - ‘airline_data.zip’ saved [25613885/25613885]\n\nArchive:  airline_data.zip\n   creating: airline_data/\n  inflating: airline_data/test_df.csv  \nreplace __MACOSX/airline_data/._test_df.csv? [y]es, [n]o, [A]ll, [N]one, [r]ename:  NULL\n(EOF or read error, treating as \"[N]one\" ...)\n  inflating: airline_data/train_df.csv  \nFound 2 items\n-rw-r--r--   3 zeppelin hdfs   40744388 2018-04-23 22:15 /tmp/airline_delays/test_df.csv\n-rw-r--r--   3 zeppelin hdfs   57626420 2018-04-23 22:15 /tmp/airline_delays/train_df.csv\n"}]},"apps":[],"jobName":"paragraph_1524487913589_1735533100","id":"20180423-125153_1122800085","dateCreated":"2018-04-23T12:51:53+0000","dateStarted":"2018-04-23T22:15:39+0000","dateFinished":"2018-04-23T22:15:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:209"},{"title":"Load Python Libraries","text":"%pyspark\n\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import monotonically_increasing_id, col, expr, when, concat, lit, isnan\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.regression import GeneralizedLinearRegression\nfrom pyspark.ml.classification import RandomForestClassifier, LogisticRegression\nfrom pyspark.ml.feature import VectorIndexer, VectorAssembler, StringIndexer, OneHotEncoder\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator, RegressionEvaluator, BinaryClassificationEvaluator\nfrom pyspark.ml import Pipeline","user":"admin","dateUpdated":"2018-04-24T16:44:41+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[],"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524487461835_-794298188","id":"20170323-141100_836862574","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:44:41+0000","dateFinished":"2018-04-24T16:44:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:210"},{"title":"Load Data","text":"%pyspark\n\ntrain_df = spark.read.load(\"hdfs:///tmp/airline_delays/train_df.csv\", \"csv\", delimiter=\",\", inferSchema=True, header=True)\n\ntrain_df.createOrReplaceTempView(\"train_df\")\n","user":"admin","dateUpdated":"2018-04-24T16:44:41+0000","config":{"tableHide":false,"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524487461835_-794298188","id":"20170320-023442_13943793","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:44:41+0000","dateFinished":"2018-04-24T16:44:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:211"},{"title":"What does my dataset look like?  (Can also look at Correlation)","text":"%sql\nselect * from train_df LIMIT 100","user":"admin","dateUpdated":"2018-04-24T16:44:41+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"vehicle_id","index":0,"aggr":"sum"}],"values":[{"name":"tip_amount","index":12,"aggr":"sum"},{"name":"vehicle_id","index":0,"aggr":"count"}],"groups":[],"scatter":{"xAxis":{"name":"trip_distance","index":4,"aggr":"sum"},"yAxis":{"name":"fare_amount","index":9,"aggr":"sum"},"size":{"name":"tip_amount","index":12,"aggr":"sum"}}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"YEAR\tMONTH\tDAY_OF_MONTH\tDAY_OF_WEEK\tCARRIER\tFL_NUM\tORIGIN\tDEST\tDEP_TIME\tDEP_DELAY\tARR_TIME\tARR_DELAY\tCANCELLED\tCANCELLATION_CODE\tAIR_TIME\tDISTANCE\tWEEKEND\tDEP_HOUR\tDELAY_LABELED\n2015\t1\t1\t4\tAA\t1\tJFK\tLAX\t855\t-5\t1237\t7\t0\tnull\t378\t2475\t0\t8\t0\n2015\t1\t2\t5\tAA\t1\tJFK\tLAX\t850\t-10\t1211\t-19\t0\tnull\t357\t2475\t1\t8\t0\n2015\t1\t3\t6\tAA\t1\tJFK\tLAX\t853\t-7\t1151\t-39\t0\tnull\t330\t2475\t1\t8\t0\n2015\t1\t4\t7\tAA\t1\tJFK\tLAX\t853\t-7\t1218\t-12\t0\tnull\t352\t2475\t1\t8\t0\n2015\t1\t5\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1222\t-8\t0\tnull\t338\t2475\t0\t8\t0\n2015\t1\t6\t2\tAA\t1\tJFK\tLAX\t856\t-4\t1300\t25\t0\tnull\t335\t2475\t0\t8\t1\n2015\t1\t7\t3\tAA\t1\tJFK\tLAX\t859\t-1\t1221\t-14\t0\tnull\t341\t2475\t0\t8\t0\n2015\t1\t8\t4\tAA\t1\tJFK\tLAX\t856\t-4\t1158\t-37\t0\tnull\t333\t2475\t0\t8\t0\n2015\t1\t9\t5\tAA\t1\tJFK\tLAX\t901\t1\t1241\t6\t0\tnull\t353\t2475\t1\t9\t0\n2015\t1\t10\t6\tAA\t1\tJFK\tLAX\t903\t3\t1235\t0\t0\tnull\t345\t2475\t1\t9\t0\n2015\t1\t11\t7\tAA\t1\tJFK\tLAX\t854\t-6\t1159\t-36\t0\tnull\t337\t2475\t1\t8\t0\n2015\t1\t12\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1230\t-5\t0\tnull\t354\t2475\t0\t8\t0\n2015\t1\t13\t2\tAA\t1\tJFK\tLAX\t854\t-6\t1155\t-40\t0\tnull\t336\t2475\t0\t8\t0\n2015\t1\t14\t3\tAA\t1\tJFK\tLAX\t856\t-4\t1126\t-69\t0\tnull\t302\t2475\t0\t8\t0\n2015\t1\t15\t4\tAA\t1\tJFK\tLAX\t852\t-8\t1231\t-4\t0\tnull\t320\t2475\t0\t8\t0\n2015\t1\t16\t5\tAA\t1\tJFK\tLAX\t900\t0\t1206\t-29\t0\tnull\t321\t2475\t1\t9\t0\n2015\t1\t17\t6\tAA\t1\tJFK\tLAX\t852\t-8\t1157\t-38\t0\tnull\t343\t2475\t1\t8\t0\n2015\t1\t18\t7\tAA\t1\tJFK\tLAX\t916\t16\t1236\t1\t0\tnull\t340\t2475\t1\t9\t0\n2015\t1\t19\t1\tAA\t1\tJFK\tLAX\t854\t-6\t1218\t-17\t0\tnull\t359\t2475\t0\t8\t0\n2015\t1\t20\t2\tAA\t1\tJFK\tLAX\t853\t-7\t1203\t-32\t0\tnull\t349\t2475\t0\t8\t0\n2015\t1\t21\t3\tAA\t1\tJFK\tLAX\t853\t-7\t1142\t-53\t0\tnull\t327\t2475\t0\t8\t0\n2015\t1\t22\t4\tAA\t1\tJFK\tLAX\t852\t-8\t1150\t-45\t0\tnull\t324\t2475\t0\t8\t0\n2015\t1\t23\t5\tAA\t1\tJFK\tLAX\t854\t-6\t1146\t-49\t0\tnull\t328\t2475\t1\t8\t0\n2015\t1\t24\t6\tAA\t1\tJFK\tLAX\t1043\t103\t1354\t79\t0\tnull\t323\t2475\t1\t10\t1\n2015\t1\t25\t7\tAA\t1\tJFK\tLAX\t903\t3\t1145\t-50\t0\tnull\t308\t2475\t1\t9\t0\n2015\t1\t26\t1\tAA\t1\tJFK\tLAX\t854\t-6\t1240\t5\t0\tnull\t337\t2475\t0\t8\t0\n2015\t1\t29\t4\tAA\t1\tJFK\tLAX\t855\t-5\t1217\t-18\t0\tnull\t349\t2475\t0\t8\t0\n2015\t1\t30\t5\tAA\t1\tJFK\tLAX\t858\t-2\t1242\t7\t0\tnull\t352\t2475\t1\t8\t0\n2015\t1\t31\t6\tAA\t1\tJFK\tLAX\t854\t-6\t1222\t-13\t0\tnull\t347\t2475\t1\t8\t0\n2015\t1\t1\t4\tAA\t2\tLAX\tJFK\t856\t-4\t1651\t-44\t0\tnull\t271\t2475\t0\t8\t0\n2015\t1\t2\t5\tAA\t2\tLAX\tJFK\t854\t-6\t1727\t-8\t0\tnull\t294\t2475\t1\t8\t0\n2015\t1\t3\t6\tAA\t2\tLAX\tJFK\t922\t22\t1759\t24\t0\tnull\t297\t2475\t1\t9\t1\n2015\t1\t4\t7\tAA\t2\tLAX\tJFK\t1141\t161\t2005\t150\t0\tnull\t291\t2475\t1\t11\t1\n2015\t1\t5\t1\tAA\t2\tLAX\tJFK\t852\t-8\t1720\t-15\t0\tnull\t293\t2475\t0\t8\t0\n2015\t1\t6\t2\tAA\t2\tLAX\tJFK\t858\t-2\t1711\t-18\t0\tnull\t278\t2475\t0\t8\t0\n2015\t1\t7\t3\tAA\t2\tLAX\tJFK\t850\t-10\t1710\t-19\t0\tnull\t298\t2475\t0\t8\t0\n2015\t1\t8\t4\tAA\t2\tLAX\tJFK\t853\t-7\t1709\t-20\t0\tnull\t285\t2475\t0\t8\t0\n2015\t1\t9\t5\tAA\t2\tLAX\tJFK\t852\t-8\t1711\t-18\t0\tnull\t293\t2475\t1\t8\t0\n2015\t1\t10\t6\tAA\t2\tLAX\tJFK\t858\t-2\t1722\t-7\t0\tnull\t284\t2475\t1\t8\t0\n2015\t1\t11\t7\tAA\t2\tLAX\tJFK\t853\t-7\t1723\t-6\t0\tnull\t302\t2475\t1\t8\t0\n2015\t1\t12\t1\tAA\t2\tLAX\tJFK\t900\t0\t1738\t9\t0\tnull\t295\t2475\t0\t9\t0\n2015\t1\t13\t2\tAA\t2\tLAX\tJFK\t857\t-3\t1720\t-9\t0\tnull\t293\t2475\t0\t8\t0\n2015\t1\t14\t3\tAA\t2\tLAX\tJFK\t854\t-6\t1722\t-7\t0\tnull\t301\t2475\t0\t8\t0\n2015\t1\t15\t4\tAA\t2\tLAX\tJFK\t857\t-3\t1731\t2\t0\tnull\t303\t2475\t0\t8\t0\n2015\t1\t16\t5\tAA\t2\tLAX\tJFK\t853\t-7\t1726\t-3\t0\tnull\t306\t2475\t1\t8\t0\n2015\t1\t17\t6\tAA\t2\tLAX\tJFK\t854\t-6\t1719\t-10\t0\tnull\t300\t2475\t1\t8\t0\n2015\t1\t18\t7\tAA\t2\tLAX\tJFK\t856\t-4\t1729\t0\t0\tnull\t313\t2475\t1\t8\t0\n2015\t1\t19\t1\tAA\t2\tLAX\tJFK\t856\t-4\t1709\t-20\t0\tnull\t284\t2475\t0\t8\t0\n2015\t1\t20\t2\tAA\t2\tLAX\tJFK\t857\t-3\t1710\t-19\t0\tnull\t284\t2475\t0\t8\t0\n2015\t1\t21\t3\tAA\t2\tLAX\tJFK\t852\t-8\t1659\t-30\t0\tnull\t280\t2475\t0\t8\t0\n2015\t1\t22\t4\tAA\t2\tLAX\tJFK\t855\t-5\t1710\t-19\t0\tnull\t290\t2475\t0\t8\t0\n2015\t1\t23\t5\tAA\t2\tLAX\tJFK\t852\t-8\t1714\t-15\t0\tnull\t294\t2475\t1\t8\t0\n2015\t1\t24\t6\tAA\t2\tLAX\tJFK\t851\t-9\t1740\t11\t0\tnull\t323\t2475\t1\t8\t0\n2015\t1\t25\t7\tAA\t2\tLAX\tJFK\t856\t-4\t1736\t7\t0\tnull\t313\t2475\t1\t8\t0\n2015\t1\t28\t3\tAA\t2\tLAX\tJFK\t940\t40\t1757\t28\t0\tnull\t285\t2475\t0\t9\t1\n2015\t1\t29\t4\tAA\t2\tLAX\tJFK\t854\t-6\t1714\t-15\t0\tnull\t285\t2475\t0\t8\t0\n2015\t1\t30\t5\tAA\t2\tLAX\tJFK\t853\t-7\t1722\t-7\t0\tnull\t285\t2475\t1\t8\t0\n2015\t1\t31\t6\tAA\t2\tLAX\tJFK\t854\t-6\t1706\t-23\t0\tnull\t277\t2475\t1\t8\t0\n2015\t1\t1\t4\tAA\t3\tJFK\tLAX\t1226\t-4\t1548\t-2\t0\tnull\t358\t2475\t0\t12\t0\n2015\t1\t2\t5\tAA\t3\tJFK\tLAX\t1219\t-11\t1520\t-30\t0\tnull\t339\t2475\t1\t12\t0\n2015\t1\t3\t6\tAA\t3\tJFK\tLAX\t1227\t-3\t1536\t-14\t0\tnull\t333\t2475\t1\t12\t0\n2015\t1\t4\t7\tAA\t3\tJFK\tLAX\t1226\t-4\t1546\t-4\t0\tnull\t347\t2475\t1\t12\t0\n2015\t1\t5\t1\tAA\t3\tJFK\tLAX\t1224\t-6\t1554\t4\t0\tnull\t349\t2475\t0\t12\t0\n2015\t1\t6\t2\tAA\t3\tJFK\tLAX\t1227\t-3\t1647\t52\t0\tnull\t370\t2475\t0\t12\t1\n2015\t1\t7\t3\tAA\t3\tJFK\tLAX\t1225\t-5\t1531\t-24\t0\tnull\t341\t2475\t0\t12\t0\n2015\t1\t8\t4\tAA\t3\tJFK\tLAX\t1228\t-2\t1547\t-8\t0\tnull\t358\t2475\t0\t12\t0\n2015\t1\t9\t5\tAA\t3\tJFK\tLAX\t1230\t0\t1613\t18\t0\tnull\t346\t2475\t1\t12\t1\n2015\t1\t10\t6\tAA\t3\tJFK\tLAX\t1226\t-4\t1553\t-2\t0\tnull\t353\t2475\t1\t12\t0\n2015\t1\t11\t7\tAA\t3\tJFK\tLAX\t1233\t3\t1535\t-20\t0\tnull\t341\t2475\t1\t12\t0\n2015\t1\t12\t1\tAA\t3\tJFK\tLAX\t1226\t-4\t1605\t10\t0\tnull\t368\t2475\t0\t12\t0\n2015\t1\t13\t2\tAA\t3\tJFK\tLAX\t1223\t-7\t1525\t-30\t0\tnull\t335\t2475\t0\t12\t0\n2015\t1\t14\t3\tAA\t3\tJFK\tLAX\t1231\t1\t1503\t-52\t0\tnull\t306\t2475\t0\t12\t0\n2015\t1\t15\t4\tAA\t3\tJFK\tLAX\t1223\t-7\t1449\t-66\t0\tnull\t306\t2475\t0\t12\t0\n2015\t1\t16\t5\tAA\t3\tJFK\tLAX\t1226\t-4\t1509\t-46\t0\tnull\t322\t2475\t1\t12\t0\n2015\t1\t17\t6\tAA\t3\tJFK\tLAX\t1228\t-2\t1526\t-29\t0\tnull\t334\t2475\t1\t12\t0\n2015\t1\t18\t7\tAA\t3\tJFK\tLAX\t1228\t-2\t1528\t-27\t0\tnull\t336\t2475\t1\t12\t0\n2015\t1\t19\t1\tAA\t3\tJFK\tLAX\t1221\t-9\t1544\t-11\t0\tnull\t360\t2475\t0\t12\t0\n2015\t1\t20\t2\tAA\t3\tJFK\tLAX\t1230\t0\t1618\t23\t0\tnull\t381\t2475\t0\t12\t1\n2015\t1\t21\t3\tAA\t3\tJFK\tLAX\t1221\t-9\t1512\t-43\t0\tnull\t328\t2475\t0\t12\t0\n2015\t1\t22\t4\tAA\t3\tJFK\tLAX\t1224\t-6\t1500\t-55\t0\tnull\t308\t2475\t0\t12\t0\n2015\t1\t23\t5\tAA\t3\tJFK\tLAX\t1224\t-6\t1508\t-47\t0\tnull\t325\t2475\t1\t12\t0\n2015\t1\t24\t6\tAA\t3\tJFK\tLAX\t1226\t-4\t1529\t-26\t0\tnull\t318\t2475\t1\t12\t0\n2015\t1\t25\t7\tAA\t3\tJFK\tLAX\t1221\t-9\t1501\t-54\t0\tnull\t317\t2475\t1\t12\t0\n2015\t1\t26\t1\tAA\t3\tJFK\tLAX\t1223\t-7\t1527\t-28\t0\tnull\t317\t2475\t0\t12\t0\n2015\t1\t29\t4\tAA\t3\tJFK\tLAX\t1227\t-3\t1542\t-13\t0\tnull\t342\t2475\t0\t12\t0\n2015\t1\t30\t5\tAA\t3\tJFK\tLAX\t1259\t29\t1618\t23\t0\tnull\t346\t2475\t1\t12\t1\n2015\t1\t31\t6\tAA\t3\tJFK\tLAX\t1222\t-8\t1531\t-24\t0\tnull\t335\t2475\t1\t12\t0\n2015\t1\t1\t4\tAA\t4\tLAX\tJFK\t1214\t-6\t2033\t-17\t0\tnull\t284\t2475\t0\t12\t0\n2015\t1\t2\t5\tAA\t4\tLAX\tJFK\t1215\t-5\t2035\t-15\t0\tnull\t290\t2475\t1\t12\t0\n2015\t1\t3\t6\tAA\t4\tLAX\tJFK\t1259\t39\t2146\t56\t0\tnull\t300\t2475\t1\t12\t1\n2015\t1\t4\t7\tAA\t4\tLAX\tJFK\t1332\t72\t2158\t68\t0\tnull\t297\t2475\t1\t13\t1\n2015\t1\t5\t1\tAA\t4\tLAX\tJFK\t1243\t23\t2043\t-7\t0\tnull\t282\t2475\t0\t12\t0\n2015\t1\t6\t2\tAA\t4\tLAX\tJFK\t1247\t17\t2116\t10\t0\tnull\t294\t2475\t0\t12\t0\n2015\t1\t7\t3\tAA\t4\tLAX\tJFK\t1352\t82\t2209\t63\t0\tnull\t299\t2475\t0\t13\t1\n2015\t1\t8\t4\tAA\t4\tLAX\tJFK\t1222\t-8\t2044\t-22\t0\tnull\t292\t2475\t0\t12\t0\n2015\t1\t9\t5\tAA\t4\tLAX\tJFK\t1224\t-6\t2045\t-21\t0\tnull\t294\t2475\t1\t12\t0\n2015\t1\t10\t6\tAA\t4\tLAX\tJFK\t1232\t2\t2057\t-9\t0\tnull\t282\t2475\t1\t12\t0\n2015\t1\t11\t7\tAA\t4\tLAX\tJFK\t1638\t248\t40\t214\t0\tnull\t279\t2475\t1\t16\t1\n2015\t1\t12\t1\tAA\t4\tLAX\tJFK\t1225\t-5\t2042\t-24\t0\tnull\t296\t2475\t0\t12\t0\n2015\t1\t13\t2\tAA\t4\tLAX\tJFK\t1221\t-9\t2035\t-31\t0\tnull\t287\t2475\t0\t12\t0\n"}]},"apps":[],"jobName":"paragraph_1524487461836_-796221932","id":"20170320-110237_163337070","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:44:41+0000","dateFinished":"2018-04-24T16:44:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:212"},{"title":"Create \"Weekend\" Flag","text":"%pyspark\n\ntrain_df = train_df.withColumn(\"WEEKEND\", when((train_df.DAY_OF_WEEK == 5) | (train_df.DAY_OF_WEEK == 6) | (train_df.DAY_OF_WEEK == 7), 1).otherwise(0))\ntrain_df.show()\n","user":"admin","dateUpdated":"2018-04-24T16:44:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|\n|2015|    1|          11|          7|     AA|     1|   JFK| LAX|     854|       -6|    1159|      -36|        0|             null|     337|    2475|      1|\n|2015|    1|          12|          1|     AA|     1|   JFK| LAX|     853|       -7|    1230|       -5|        0|             null|     354|    2475|      0|\n|2015|    1|          13|          2|     AA|     1|   JFK| LAX|     854|       -6|    1155|      -40|        0|             null|     336|    2475|      0|\n|2015|    1|          14|          3|     AA|     1|   JFK| LAX|     856|       -4|    1126|      -69|        0|             null|     302|    2475|      0|\n|2015|    1|          15|          4|     AA|     1|   JFK| LAX|     852|       -8|    1231|       -4|        0|             null|     320|    2475|      0|\n|2015|    1|          16|          5|     AA|     1|   JFK| LAX|     900|        0|    1206|      -29|        0|             null|     321|    2475|      1|\n|2015|    1|          17|          6|     AA|     1|   JFK| LAX|     852|       -8|    1157|      -38|        0|             null|     343|    2475|      1|\n|2015|    1|          18|          7|     AA|     1|   JFK| LAX|     916|       16|    1236|        1|        0|             null|     340|    2475|      1|\n|2015|    1|          19|          1|     AA|     1|   JFK| LAX|     854|       -6|    1218|      -17|        0|             null|     359|    2475|      0|\n|2015|    1|          20|          2|     AA|     1|   JFK| LAX|     853|       -7|    1203|      -32|        0|             null|     349|    2475|      0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1524490297180_-467556071","id":"20180423-133137_95400914","dateCreated":"2018-04-23T13:31:37+0000","dateStarted":"2018-04-24T16:44:42+0000","dateFinished":"2018-04-24T16:44:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:213"},{"title":"Extract Departure Hour","text":"%pyspark\n\ntrain_df = train_df.withColumn(\"DEP_HOUR\", (train_df.DEP_TIME/float(100)).cast('int') )\ntrain_df.show(20)","user":"admin","dateUpdated":"2018-04-24T16:44:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|\n|2015|    1|          11|          7|     AA|     1|   JFK| LAX|     854|       -6|    1159|      -36|        0|             null|     337|    2475|      1|       8|\n|2015|    1|          12|          1|     AA|     1|   JFK| LAX|     853|       -7|    1230|       -5|        0|             null|     354|    2475|      0|       8|\n|2015|    1|          13|          2|     AA|     1|   JFK| LAX|     854|       -6|    1155|      -40|        0|             null|     336|    2475|      0|       8|\n|2015|    1|          14|          3|     AA|     1|   JFK| LAX|     856|       -4|    1126|      -69|        0|             null|     302|    2475|      0|       8|\n|2015|    1|          15|          4|     AA|     1|   JFK| LAX|     852|       -8|    1231|       -4|        0|             null|     320|    2475|      0|       8|\n|2015|    1|          16|          5|     AA|     1|   JFK| LAX|     900|        0|    1206|      -29|        0|             null|     321|    2475|      1|       9|\n|2015|    1|          17|          6|     AA|     1|   JFK| LAX|     852|       -8|    1157|      -38|        0|             null|     343|    2475|      1|       8|\n|2015|    1|          18|          7|     AA|     1|   JFK| LAX|     916|       16|    1236|        1|        0|             null|     340|    2475|      1|       9|\n|2015|    1|          19|          1|     AA|     1|   JFK| LAX|     854|       -6|    1218|      -17|        0|             null|     359|    2475|      0|       8|\n|2015|    1|          20|          2|     AA|     1|   JFK| LAX|     853|       -7|    1203|      -32|        0|             null|     349|    2475|      0|       8|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1524490532340_2066737317","id":"20180423-133532_746879178","dateCreated":"2018-04-23T13:35:32+0000","dateStarted":"2018-04-24T16:44:44+0000","dateFinished":"2018-04-24T16:44:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:214"},{"title":"Create DELAY_LABELED","text":"%pyspark\n\n# DELAY_LABELED: Has a value of 1 if the arrival delay(ARR_DELAY) is greater than 15 minutes and 0 if ARR_DELAY is less than or equal to 15 minutes.\n\ntrain_df = train_df.withColumn(\"DELAY_LABELED\", when( (train_df.ARR_DELAY > 15), 1).otherwise(0))\ntrain_df.show(10)","user":"admin","dateUpdated":"2018-04-24T16:44:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|DELAY_LABELED|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|            0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|            0|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|            0|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|            0|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|            0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|            1|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|            0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|            0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|            0|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|            0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1524490531345_-2140891979","id":"20180423-133531_307339763","dateCreated":"2018-04-23T13:35:31+0000","dateStarted":"2018-04-24T16:44:45+0000","dateFinished":"2018-04-24T16:44:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:215"},{"title":"Filter out Cancelled Flights","text":"%pyspark\n\n'''\nWe will keep only those flight records where it did not get cancelled. \nIn the next statement, we are keeping those records where the value of CANCELLED is equal to 0. (a value of 1 == CANCELLED)\n'''\n\ntrain_df = train_df.filter(train_df.CANCELLED == 0)\ntrain_df.show(10)\n","user":"admin","dateUpdated":"2018-04-24T16:44:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|DELAY_LABELED|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|            0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|            0|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|            0|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|            0|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|            0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|            1|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|            0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|            0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|            0|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|            0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1524491568731_-120486325","id":"20180423-135248_410945782","dateCreated":"2018-04-23T13:52:48+0000","dateStarted":"2018-04-24T16:44:45+0000","dateFinished":"2018-04-24T16:44:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:216"},{"title":"Remove ARR_DELAY NAs","text":"%pyspark\n\n'''\nAfter looking a dataset for a while, you will see that there are lot of NA values in ARR_DELAY column.\nWe should keep only those where we have valid readings of ARR_DELAY (remove NAs).\n'''\n\nprint(\"Initial Train_DF Count: \" + str(train_df.count()))\ntrain_df = train_df.filter( train_df.ARR_DELAY != \"NA\" )\nprint(\"New Train_DF Count:     \" + str(train_df.count()))\ntrain_df.show(10)\n","user":"admin","dateUpdated":"2018-04-24T16:44:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Initial Train_DF Count: 1033485\nNew Train_DF Count:     1030606\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|YEAR|MONTH|DAY_OF_MONTH|DAY_OF_WEEK|CARRIER|FL_NUM|ORIGIN|DEST|DEP_TIME|DEP_DELAY|ARR_TIME|ARR_DELAY|CANCELLED|CANCELLATION_CODE|AIR_TIME|DISTANCE|WEEKEND|DEP_HOUR|DELAY_LABELED|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\n|2015|    1|           1|          4|     AA|     1|   JFK| LAX|     855|       -5|    1237|        7|        0|             null|     378|    2475|      0|       8|            0|\n|2015|    1|           2|          5|     AA|     1|   JFK| LAX|     850|      -10|    1211|      -19|        0|             null|     357|    2475|      1|       8|            0|\n|2015|    1|           3|          6|     AA|     1|   JFK| LAX|     853|       -7|    1151|      -39|        0|             null|     330|    2475|      1|       8|            0|\n|2015|    1|           4|          7|     AA|     1|   JFK| LAX|     853|       -7|    1218|      -12|        0|             null|     352|    2475|      1|       8|            0|\n|2015|    1|           5|          1|     AA|     1|   JFK| LAX|     853|       -7|    1222|       -8|        0|             null|     338|    2475|      0|       8|            0|\n|2015|    1|           6|          2|     AA|     1|   JFK| LAX|     856|       -4|    1300|       25|        0|             null|     335|    2475|      0|       8|            1|\n|2015|    1|           7|          3|     AA|     1|   JFK| LAX|     859|       -1|    1221|      -14|        0|             null|     341|    2475|      0|       8|            0|\n|2015|    1|           8|          4|     AA|     1|   JFK| LAX|     856|       -4|    1158|      -37|        0|             null|     333|    2475|      0|       8|            0|\n|2015|    1|           9|          5|     AA|     1|   JFK| LAX|     901|        1|    1241|        6|        0|             null|     353|    2475|      1|       9|            0|\n|2015|    1|          10|          6|     AA|     1|   JFK| LAX|     903|        3|    1235|        0|        0|             null|     345|    2475|      1|       9|            0|\n+----+-----+------------+-----------+-------+------+------+----+--------+---------+--------+---------+---------+-----------------+--------+--------+-------+--------+-------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1524491835614_807110981","id":"20180423-135715_359504819","dateCreated":"2018-04-23T13:57:15+0000","dateStarted":"2018-04-24T16:44:45+0000","dateFinished":"2018-04-24T16:44:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:217"},{"title":"What is the Schema?  How many records?","text":"%pyspark\n\nprint '\\r\\nTotal Records: ' + str(train_df.count()) + '\\r\\n\\r\\n'\nfor i in train_df.dtypes: print str(i)\n","user":"admin","dateUpdated":"2018-04-24T16:44:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\r\nTotal Records: 1030606\r\n\r\n\n('YEAR', 'int')\n('MONTH', 'int')\n('DAY_OF_MONTH', 'int')\n('DAY_OF_WEEK', 'int')\n('CARRIER', 'string')\n('FL_NUM', 'int')\n('ORIGIN', 'string')\n('DEST', 'string')\n('DEP_TIME', 'string')\n('DEP_DELAY', 'string')\n('ARR_TIME', 'string')\n('ARR_DELAY', 'string')\n('CANCELLED', 'int')\n('CANCELLATION_CODE', 'string')\n('AIR_TIME', 'string')\n('DISTANCE', 'int')\n('WEEKEND', 'int')\n('DEP_HOUR', 'int')\n('DELAY_LABELED', 'int')\n"}]},"apps":[],"jobName":"paragraph_1524487461837_-796606681","id":"20170320-105240_996898077","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:44:46+0000","dateFinished":"2018-04-24T16:44:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:218"},{"title":"Convert from String to Int","text":"%pyspark\n\n'''\nWe should convert the type of ARR_DELAY and DEP_DELAY from string to integer so that we can perform mathematical operations on that.\n'''\n\ntrain_df = train_df.withColumn(\"ARR_DELAY\",     col(\"ARR_DELAY\").cast(\"int\")) \\\n                   .withColumn(\"DEP_DELAY\",     col(\"DEP_DELAY\").cast(\"int\")) \\\n                   .withColumn(\"AIR_TIME\",      col(\"AIR_TIME\").cast(\"int\"))  \\\n                   .withColumn(\"DAY_OF_WEEK\",   col(\"DAY_OF_WEEK\").cast(\"string\"))\n \ntrain_df.dtypes\ntrain_df.createOrReplaceTempView(\"train_df\")\n","user":"admin","dateUpdated":"2018-04-24T16:44:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524493982474_-1440576246","id":"20180423-143302_702987549","dateCreated":"2018-04-23T14:33:02+0000","dateStarted":"2018-04-24T16:44:49+0000","dateFinished":"2018-04-24T16:44:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:219"},{"title":"EXPLORATORY DATA ANALYSIS - Find the number of delays (and on-time flights) by Airline Carrier","text":"%sql\n\nSELECT CARRIER, DELAY_LABELED, count(*) as count\n    FROM train_df \n    GROUP BY CARRIER, DELAY_LABELED \n    LIMIT 20","user":"admin","dateUpdated":"2018-04-24T16:44:42+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"CARRIER","index":0,"aggr":"sum"}],"values":[{"name":"count","index":2,"aggr":"sum"}],"groups":[{"name":"DELAY_LABELED","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"vehicle_id","index":0,"aggr":"sum"},"yAxis":{"name":"avg_distance","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{}}}],"enabled":true,"runOnSelectionChange":true},"settings":{"params":{"OrderBy":"avg_distance"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CARRIER\tDELAY_LABELED\tcount\nUA\t0\t189131\nDL\t0\t385200\nUA\t1\t55749\nAA\t0\t269059\nAA\t1\t67234\nDL\t1\t64233\n"}]},"apps":[],"jobName":"paragraph_1524487461838_-795452435","id":"20170320-105033_610898887","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:44:50+0000","dateFinished":"2018-04-24T16:44:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:220"},{"title":"EXPLORATORY ANALYSIS - Create Delay DataFrame (% of on-time vs delayed flights)","text":"%pyspark\n\n'''\nWe create a new dataframe called delay which will have two columns, DELAY_LABELED and the count of it. \nBasically it will have a count of delayed flights and ontime flights. We will be using aggregate where we group the \ndataframe by DELAY_LABELED and calculating the count using n().\n'''\n\ndelay = train_df.groupBy( train_df.DELAY_LABELED ).count() \\\n                .withColumn(\"STATUS\", when( col(\"DELAY_LABELED\") == 0, \"ontime\").otherwise(\"delayed\") ) \\\n                .drop(\"DELAY_LABELED\")\n\ndelay.show()\n\ntotal = delay.select(\"count\").collect()[0][0] + delay.select(\"count\").collect()[1][0]\n\nprint(\"Total Count: \" + str(total))\n\ndelay_r = delay.withColumn(\"PERCENTAGE\", (col(\"count\")/float(total)*100) )\ndelay_r.createOrReplaceTempView(\"delay_r\")\n\ndelay_r.show()","user":"admin","dateUpdated":"2018-04-24T16:44:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+\n| count| STATUS|\n+------+-------+\n|187216|delayed|\n|843390| ontime|\n+------+-------+\n\nTotal Count: 1030606\n+------+-------+-----------------+\n| count| STATUS|       PERCENTAGE|\n+------+-------+-----------------+\n|187216|delayed|18.16562294417071|\n|843390| ontime| 81.8343770558293|\n+------+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1524494638406_1091820233","id":"20180423-144358_1355204171","dateCreated":"2018-04-23T14:43:58+0000","dateStarted":"2018-04-24T16:44:51+0000","dateFinished":"2018-04-24T16:45:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:221"},{"title":"EXPLORATORY ANALYSIS - Percentage of On-Time VS Delayed Flights","text":"%sql\n\nselect DELAY_LABELED, count(*) as count from train_df\n    group by DELAY_LABELED\n","user":"admin","dateUpdated":"2018-04-24T16:44:42+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":[{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"DELAY_LABELED","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"pickup_longitude","index":3,"aggr":"sum"},"yAxis":{"name":"pickup_latitude","index":2,"aggr":"sum"},"size":{"name":"fare_amount","index":9,"aggr":"sum"}},"setting":{"pieChart":{}},"commonSetting":{}},"helium":{}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DELAY_LABELED\tcount\n1\t187216\n0\t843390\n"}]},"apps":[],"jobName":"paragraph_1524487461838_-795452435","id":"20170320-023510_703313108","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:44:51+0000","dateFinished":"2018-04-24T16:45:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:222"},{"title":"Compare Delays VS Non-Delays by Day of Week (1=Monday, 7=Sunday)","text":"%pyspark\n\ndelay_flights_count = train_df.filter( train_df.DELAY_LABELED == 1 ) \\\n                              .groupby( train_df.DAY_OF_WEEK ).count() \\\n                              .withColumnRenamed( \"count\", \"DELAY_COUNT\")\n\nnon_delay_flights_count = train_df.filter( train_df.DELAY_LABELED == 0 ) \\\n                              .groupby( train_df.DAY_OF_WEEK ).count() \\\n                              .withColumnRenamed( \"count\", \"NON_DELAY_COUNT\")\n\ndayofweek_count = delay_flights_count.join(non_delay_flights_count, delay_flights_count[\"DAY_OF_WEEK\"] == non_delay_flights_count[\"DAY_OF_WEEK\"] ) \\\n                                     .drop( non_delay_flights_count.DAY_OF_WEEK ) \\\n                                     .sort( col(\"DAY_OF_WEEK\") )\n\ndayofweek_count.createOrReplaceTempView(\"dayofweek_count\")\ndayofweek_count.show()","user":"admin","dateUpdated":"2018-04-24T16:44:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----------+---------------+\n|DELAY_COUNT|DAY_OF_WEEK|NON_DELAY_COUNT|\n+-----------+-----------+---------------+\n|      31396|          1|         120871|\n|      26323|          2|         120897|\n|      24874|          3|         124656|\n|      30381|          4|         127328|\n|      29230|          5|         127520|\n|      19393|          6|         103732|\n|      25619|          7|         118386|\n+-----------+-----------+---------------+\n\n"}]},"apps":[],"jobName":"paragraph_1524495982199_-783622400","id":"20180423-150622_233344042","dateCreated":"2018-04-23T15:06:22+0000","dateStarted":"2018-04-24T16:44:55+0000","dateFinished":"2018-04-24T16:45:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:223"},{"title":"Percentage of Delays by Day of Week (1=Monday, 7=Sunday)","text":"%sql\n\nselect DAY_OF_WEEK, ((DELAY_COUNT / (DELAY_COUNT + NON_DELAY_COUNT))*100) AS DELAY_PERCENT\n    from dayofweek_count\n    \n","user":"admin","dateUpdated":"2018-04-24T16:45:07+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"DAY_OF_WEEK","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"DELAY_PERCENT","index":1,"aggr":"avg"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DAY_OF_WEEK\tDELAY_PERCENT\n1\t20.61904417897509\n2\t17.8800434723543\n3\t16.634789005550726\n4\t19.26396083926726\n5\t18.647527910685806\n6\t15.750659898477156\n7\t17.790354501579806\n"}]},"apps":[],"jobName":"paragraph_1524497766279_-194629318","id":"20180423-153606_25272067","dateCreated":"2018-04-23T15:36:06+0000","dateStarted":"2018-04-24T16:45:07+0000","dateFinished":"2018-04-24T16:45:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:224"},{"title":"Percentage of Delays by Origin","text":"%sql\n\nselect ORIGIN, round((sum(DELAY_LABELED) / count(*))*100, 2) as delay_percentage\n    from train_df\n    group by ORIGIN\n    order by delay_percentage desc","user":"admin","dateUpdated":"2018-04-24T16:45:07+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ORIGIN\tdelay_percentage\nBQN\t33.56\nMTJ\t25.88\nORD\t25.34\nIAH\t24.54\nLBB\t24.32\nEWR\t23.43\nDEN\t23.35\nLGA\t23.18\nIAD\t23.05\nMIA\t22.74\nJFK\t21.88\nFAT\t21.74\nBOS\t21.53\nDFW\t21.39\nGUC\t20.95\nEGE\t20.94\nCLT\t20.68\nHDN\t20.56\nDCA\t19.91\nPHL\t19.75\nSFO\t19.68\nSTT\t19.41\nANC\t18.74\nLAX\t18.58\nSTX\t18.5\nPBI\t18.12\nGUM\t17.98\nMCO\t17.84\nCOS\t17.62\nDTW\t17.56\nFAI\t17.48\nBWI\t17.32\nPSP\t17.31\nBNA\t17.21\nOGG\t16.94\nMSY\t16.72\nRDU\t16.54\nLAS\t16.47\nALB\t16.44\nELP\t16.42\nSEA\t16.23\nSJU\t16.09\nTPA\t16.0\nSTL\t15.97\nDSM\t15.96\nITO\t15.87\nAUS\t15.79\nPHX\t15.75\nCRW\t15.51\nCMH\t15.51\nSMF\t15.15\nABQ\t15.06\nMFE\t15.05\nBDL\t15.03\nMKE\t15.01\nRIC\t14.95\nICT\t14.73\nCLE\t14.66\nMCI\t14.62\nGRB\t14.6\nPIT\t14.6\nJAC\t14.59\nMDW\t14.53\nAGS\t14.53\nHNL\t14.44\nOMA\t14.36\nTUL\t14.31\nONT\t14.31\nMSP\t14.19\nIND\t14.04\nSHV\t14.01\nMSN\t13.96\nSNA\t13.85\nMEM\t13.81\nRSW\t13.73\nATL\t13.72\nSAN\t13.67\nBUF\t13.63\nKOA\t13.5\nSAT\t13.49\nMDT\t13.4\nDAY\t13.38\nFLL\t13.24\nPVD\t13.23\nECP\t13.1\nOKC\t13.1\nSAV\t13.05\nPDX\t12.99\nSDF\t12.95\nROC\t12.83\nPWM\t12.82\nRNO\t12.65\nSRQ\t12.58\nJAX\t12.55\nSJC\t12.53\nPNS\t12.39\nSLC\t12.39\nBHM\t12.31\nHOU\t12.09\nAVL\t12.06\nDAL\t12.01\nTRI\t11.93\nBZN\t11.86\nTUS\t11.8\nLFT\t11.56\nFAR\t11.53\nGRR\t11.41\nLIT\t11.4\nMLB\t11.34\nDAB\t11.23\nORF\t11.17\nDLH\t11.11\nROA\t11.11\nLIH\t10.89\nCVG\t10.87\nGPT\t10.86\nABE\t10.73\nGSP\t10.58\nVPS\t10.54\nGEG\t10.43\nJAN\t10.3\nBTR\t10.23\nCHS\t10.16\nEVV\t10.16\nFSD\t9.94\nBOI\t9.9\nGNV\t9.78\nBIL\t9.67\nHSV\t9.67\nCHA\t9.64\nXNA\t9.57\nGSO\t9.49\nTVC\t9.46\nMYR\t9.18\nILM\t9.13\nSYR\t9.04\nTYS\t9.01\nEYW\t8.98\nLEX\t8.45\nFCA\t8.42\nCAK\t8.29\nTLH\t8.19\nCAE\t8.01\nATW\t7.96\nMHT\t7.83\nFNT\t7.71\nMOB\t7.28\nFAY\t7.17\nJNU\t6.9\nPHF\t6.17\nOAK\t5.75\nBGR\t5.45\nBTV\t5.26\nRAP\t5.26\nPSC\t4.89\nSGF\t4.69\nCHO\t4.49\nMSO\t4.27\nBIS\t1.95\nLAN\t0.0\nMOT\t0.0\nAVP\t0.0\n"}]},"apps":[],"jobName":"paragraph_1524498167348_1903990397","id":"20180423-154247_471724541","dateCreated":"2018-04-23T15:42:47+0000","dateStarted":"2018-04-24T16:45:07+0000","dateFinished":"2018-04-24T16:45:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:225"},{"title":"Display Descriptive Stats","text":"%pyspark\n\ntrain_df.describe(['day_of_month','day_of_week','dep_delay','arr_delay','cancelled','air_time','distance','delay_labeled']).show()\n","user":"admin","dateUpdated":"2018-04-24T16:44:42+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+------------------+------------------+------------------+---------+------------------+------------------+-------------------+\n|summary|     day_of_month|       day_of_week|         dep_delay|         arr_delay|cancelled|          air_time|          distance|      delay_labeled|\n+-------+-----------------+------------------+------------------+------------------+---------+------------------+------------------+-------------------+\n|  count|          1030606|           1030606|           1030606|           1030606|  1030606|           1030606|           1030606|            1030606|\n|   mean|15.39944071740316|3.9361967619051317|10.939452128165371|4.4964680974106495|      0.0|137.35455644543114|1027.7749382402199|0.18165622944170712|\n| stddev|8.730470469828362|1.9823334094478253|41.687449968749256| 44.15147169489577|      0.0| 79.03324434313015| 667.7328895728251|0.38556113391967606|\n|    min|                1|                 1|               -68|               -87|        0|                17|                74|                  0|\n|    max|               31|                 7|              1988|              1971|        0|               683|              4983|                  1|\n+-------+-----------------+------------------+------------------+------------------+---------+------------------+------------------+-------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1524487461839_-795837183","id":"20170320-095829_431145914","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:45:18+0000","dateFinished":"2018-04-24T16:45:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:226"},{"title":"Print out the most current (train_df) table","text":"%sql\n\nselect * from train_df limit 20","user":"admin","dateUpdated":"2018-04-24T16:45:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"YEAR\tMONTH\tDAY_OF_MONTH\tDAY_OF_WEEK\tCARRIER\tFL_NUM\tORIGIN\tDEST\tDEP_TIME\tDEP_DELAY\tARR_TIME\tARR_DELAY\tCANCELLED\tCANCELLATION_CODE\tAIR_TIME\tDISTANCE\tWEEKEND\tDEP_HOUR\tDELAY_LABELED\n2015\t1\t1\t4\tAA\t1\tJFK\tLAX\t855\t-5\t1237\t7\t0\tnull\t378\t2475\t0\t8\t0\n2015\t1\t2\t5\tAA\t1\tJFK\tLAX\t850\t-10\t1211\t-19\t0\tnull\t357\t2475\t1\t8\t0\n2015\t1\t3\t6\tAA\t1\tJFK\tLAX\t853\t-7\t1151\t-39\t0\tnull\t330\t2475\t1\t8\t0\n2015\t1\t4\t7\tAA\t1\tJFK\tLAX\t853\t-7\t1218\t-12\t0\tnull\t352\t2475\t1\t8\t0\n2015\t1\t5\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1222\t-8\t0\tnull\t338\t2475\t0\t8\t0\n2015\t1\t6\t2\tAA\t1\tJFK\tLAX\t856\t-4\t1300\t25\t0\tnull\t335\t2475\t0\t8\t1\n2015\t1\t7\t3\tAA\t1\tJFK\tLAX\t859\t-1\t1221\t-14\t0\tnull\t341\t2475\t0\t8\t0\n2015\t1\t8\t4\tAA\t1\tJFK\tLAX\t856\t-4\t1158\t-37\t0\tnull\t333\t2475\t0\t8\t0\n2015\t1\t9\t5\tAA\t1\tJFK\tLAX\t901\t1\t1241\t6\t0\tnull\t353\t2475\t1\t9\t0\n2015\t1\t10\t6\tAA\t1\tJFK\tLAX\t903\t3\t1235\t0\t0\tnull\t345\t2475\t1\t9\t0\n2015\t1\t11\t7\tAA\t1\tJFK\tLAX\t854\t-6\t1159\t-36\t0\tnull\t337\t2475\t1\t8\t0\n2015\t1\t12\t1\tAA\t1\tJFK\tLAX\t853\t-7\t1230\t-5\t0\tnull\t354\t2475\t0\t8\t0\n2015\t1\t13\t2\tAA\t1\tJFK\tLAX\t854\t-6\t1155\t-40\t0\tnull\t336\t2475\t0\t8\t0\n2015\t1\t14\t3\tAA\t1\tJFK\tLAX\t856\t-4\t1126\t-69\t0\tnull\t302\t2475\t0\t8\t0\n2015\t1\t15\t4\tAA\t1\tJFK\tLAX\t852\t-8\t1231\t-4\t0\tnull\t320\t2475\t0\t8\t0\n2015\t1\t16\t5\tAA\t1\tJFK\tLAX\t900\t0\t1206\t-29\t0\tnull\t321\t2475\t1\t9\t0\n2015\t1\t17\t6\tAA\t1\tJFK\tLAX\t852\t-8\t1157\t-38\t0\tnull\t343\t2475\t1\t8\t0\n2015\t1\t18\t7\tAA\t1\tJFK\tLAX\t916\t16\t1236\t1\t0\tnull\t340\t2475\t1\t9\t0\n2015\t1\t19\t1\tAA\t1\tJFK\tLAX\t854\t-6\t1218\t-17\t0\tnull\t359\t2475\t0\t8\t0\n2015\t1\t20\t2\tAA\t1\tJFK\tLAX\t853\t-7\t1203\t-32\t0\tnull\t349\t2475\t0\t8\t0\n"}]},"apps":[],"jobName":"paragraph_1524499063157_-472351794","id":"20180423-155743_1963966507","dateCreated":"2018-04-23T15:57:43+0000","dateStarted":"2018-04-24T16:45:18+0000","dateFinished":"2018-04-24T16:45:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:227"},{"title":"Train and Test DataFrames","text":"%pyspark\n\n# Process Training DataFrame\nmodel_train_df = train_df\n# Filter for certain Airports (based on airport code) for both \"Origin\" and \"Dest\" variables.\nmodel_train_df = model_train_df[model_train_df.ORIGIN.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\nmodel_train_df = model_train_df[model_train_df.DEST.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\n# Stratified Sampling\nmodel_train_df = model_train_df.sampleBy(\"delay_labeled\", fractions={0: 0.4, 1: 0.99}, seed=1111)\n\n# Process Test DataFrame\nmodel_test_df = spark.read.load(\"hdfs:///tmp/airline_delays/test_df.csv\", \"csv\", delimiter=\",\", inferSchema=True, header=True)\nmodel_test_df = model_test_df[model_test_df.ORIGIN.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\nmodel_test_df = model_test_df[model_test_df.DEST.isin(\"LAX\",\"JFK\",\"LGA\",\"ORD\",\"ATL\",\"SFO\",\"DTW\",\"SLC\",\"CLT\",\"DEN\",\"LAS\",\"SEA\",\"MCO\",\"MIA\",\"PHX\",\"IAH\")]\nmodel_test_df = model_test_df.withColumn(\"WEEKEND\", when((model_test_df.DAY_OF_WEEK == 5) | (model_test_df.DAY_OF_WEEK == 6) | (model_test_df.DAY_OF_WEEK == 7), 1).otherwise(0))\nmodel_test_df = model_test_df.withColumn(\"DEP_HOUR\", (model_test_df.DEP_TIME/float(100)).cast('int') )\nmodel_test_df = model_test_df.withColumn(\"DELAY_LABELED\", when( (model_test_df.ARR_DELAY > 15), 1).otherwise(0))\nmodel_test_df = model_test_df.filter(model_test_df.CANCELLED == 0)\nmodel_test_df = model_test_df.filter( model_test_df.ARR_DELAY != \"NA\" )\nmodel_test_df = model_test_df.withColumn(\"ARR_DELAY\",     col(\"ARR_DELAY\").cast(\"int\")) \\\n                             .withColumn(\"DEP_DELAY\",     col(\"DEP_DELAY\").cast(\"int\")) \\\n                             .withColumn(\"AIR_TIME\",      col(\"AIR_TIME\").cast(\"int\"))  \\\n                             .withColumn(\"DAY_OF_WEEK\",   col(\"DAY_OF_WEEK\").cast(\"string\"))\n\n\nprint(\"Training Record Count:  \" + str(model_train_df.count()))\nprint(\"Testing Record Count:   \" + str(model_test_df.count()))\n","user":"admin","dateUpdated":"2018-04-24T16:45:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Training Record Count:  141465\nTesting Record Count:   192422\n"}]},"apps":[],"jobName":"paragraph_1524499510657_-218987279","id":"20180423-160510_290046713","dateCreated":"2018-04-23T16:05:10+0000","dateStarted":"2018-04-24T16:45:29+0000","dateFinished":"2018-04-24T16:45:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:228"},{"text":"%pyspark\n\nmodel_train_df.groupBy(\"delay_labeled\").count().show()","user":"admin","dateUpdated":"2018-04-24T16:45:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+\n|delay_labeled|count|\n+-------------+-----+\n|            1|54252|\n|            0|87213|\n+-------------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1524576437148_1671706427","id":"20180424-132717_692421176","dateCreated":"2018-04-24T13:27:17+0000","dateStarted":"2018-04-24T16:45:29+0000","dateFinished":"2018-04-24T16:45:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:229"},{"title":"Model Prep and Transformations","text":"%pyspark\n\n# Index string variables (using string indexer)\nsi1  = StringIndexer(inputCol=\"DAY_OF_WEEK\", outputCol=\"DAY_OF_WEEK_index\")\nsi2  = StringIndexer(inputCol=\"CARRIER\",     outputCol=\"CARRIER_index\")\nsi3  = StringIndexer(inputCol=\"ORIGIN\",      outputCol=\"ORIGIN_index\")\nsi4  = StringIndexer(inputCol=\"DEST\",        outputCol=\"DEST_index\")\nsi5  = StringIndexer(inputCol=\"DEP_HOUR\",    outputCol=\"DEP_HOUR_index\")\n\nohe1 = OneHotEncoder(inputCol=\"DAY_OF_WEEK_index\",  outputCol=\"DAY_OF_WEEK_ohe\")\nohe2 = OneHotEncoder(inputCol=\"CARRIER_index\",      outputCol=\"CARRIER_ohe\")\nohe3 = OneHotEncoder(inputCol=\"ORIGIN_index\",       outputCol=\"ORIGIN_ohe\")\nohe4 = OneHotEncoder(inputCol=\"DEST_index\",         outputCol=\"DEST_ohe\")\nohe5 = OneHotEncoder(inputCol=\"DEP_HOUR_index\",     outputCol=\"DEP_HOUR_ohe\")\n\ncol_target   =  'DELAY_LABELED'\ncol_features =  [\n                'DAY_OF_WEEK_index','CARRIER_index','ORIGIN_index','DEST_index','DEP_HOUR_index',\n                #'DAY_OF_WEEK_ohe','CARRIER_ohe','ORIGIN_ohe','DEST_ohe','DEP_HOUR_ohe',\n                'AIR_TIME','DISTANCE','WEEKEND'\n                ]\n\nva  = VectorAssembler(inputCols=col_features, outputCol=\"features\")\n\nrfc = RandomForestClassifier(featuresCol=\"features\", labelCol=col_target, predictionCol=\"prediction\", probabilityCol=\"probability\", numTrees=25, maxDepth=5, maxBins=32, seed=12345)\nglr = GeneralizedLinearRegression(featuresCol=\"features\", labelCol=col_target, predictionCol=\"prediction\", family=\"gaussian\", maxIter=20, regParam=0.3)\n\npipeline = Pipeline(stages=[si1,si2,si3,si4,si5,ohe1,ohe2,ohe3,ohe4,ohe5,va,rfc])\n","user":"admin","dateUpdated":"2018-04-24T16:45:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524499048282_957359795","id":"20180423-155728_1753192054","dateCreated":"2018-04-23T15:57:28+0000","dateStarted":"2018-04-24T16:45:36+0000","dateFinished":"2018-04-24T16:45:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:230"},{"title":"Model Training (Completes in ~ 30 seconds)","text":"%pyspark\n\nmodel = pipeline.fit(model_train_df)\n","user":"admin","dateUpdated":"2018-04-24T16:46:22+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524487461840_-785448963","id":"20170320-105544_864298752","dateCreated":"2018-04-23T12:44:21+0000","dateStarted":"2018-04-24T16:45:40+0000","dateFinished":"2018-04-24T16:46:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:231"},{"title":"Model Evaluation","text":"%pyspark\n\npredictions = model.transform(model_test_df)\npredictions.createOrReplaceTempView(\"predictions\")\n\n# Multiclass Evaluator\nmc_evaluator = MulticlassClassificationEvaluator(labelCol=col_target, predictionCol=\"prediction\", metricName=\"accuracy\")#f1|weightedPrecision|weightedRecall|accuracy\naccuracy     = mc_evaluator.evaluate(predictions)\nprint(\"Accuracy:       \" + str(accuracy))\n\n# Binary Evaluator\nbi_evaluator = BinaryClassificationEvaluator(labelCol=col_target, metricName='areaUnderROC')  # areaUnderROC | areaUnderPR\nareaunderroc = bi_evaluator.evaluate(predictions)\nprint(\"Area Under ROC: \" + str(areaunderroc))\n\n# Print True Positive VS False Positives\npredictions.groupBy('delay_labeled','prediction').count().show()\n\n# Print Feature Importance\nfeature_importance_vars = sorted([(col_features[i],feature) for i,feature in enumerate(model.stages[-1].featureImportances)], key=lambda x: x[1], reverse=True)\nprint('Feature Importances (descending):')\nfor f in feature_importance_vars:\n    print(f)\n","user":"admin","dateUpdated":"2018-04-24T16:46:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy:       0.80829634865\nArea Under ROC: 0.645706405637\n+-------------+----------+------+\n|delay_labeled|prediction| count|\n+-------------+----------+------+\n|            1|       0.0| 29997|\n|            0|       0.0|151729|\n|            1|       1.0|  3805|\n|            0|       1.0|  6891|\n+-------------+----------+------+\n\nFeature Importances (descending):\n('DEP_HOUR_index', 0.63221381553570188)\n('CARRIER_index', 0.13001903073155766)\n('ORIGIN_index', 0.066641490610027498)\n('DEST_index', 0.05785396457610914)\n('AIR_TIME', 0.049107986776288005)\n('DAY_OF_WEEK_index', 0.033326698386792183)\n('DISTANCE', 0.030296523841193017)\n('WEEKEND', 0.00054048954233071095)\n"}]},"apps":[],"jobName":"paragraph_1524500250598_1100407000","id":"20180423-161730_894316472","dateCreated":"2018-04-23T16:17:30+0000","dateStarted":"2018-04-24T16:46:51+0000","dateFinished":"2018-04-24T16:47:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:232"},{"text":"%sql\n\nselect delay_labeled, prediction, count(*) as counts\n    from predictions\n    group by delay_labeled, prediction","user":"admin","dateUpdated":"2018-04-24T16:55:43+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[{"name":"delay_labeled","index":0,"aggr":"sum"}],"values":[{"name":"counts","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524521593466_281410181","id":"20180423-221313_139723671","dateCreated":"2018-04-23T22:13:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:235","dateFinished":"2018-04-24T16:53:57+0000","dateStarted":"2018-04-24T16:53:49+0000","title":"Visualize Delays vs Non-Delays (actuals vs predictions)","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"delay_labeled\tprediction\tcounts\n1\t0.0\t29997\n0\t0.0\t151729\n1\t1.0\t3805\n0\t1.0\t6891\n"}]}},{"text":"%sql\n","user":"admin","dateUpdated":"2018-04-24T16:47:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524588458281_-987482487","id":"20180424-164738_1452890775","dateCreated":"2018-04-24T16:47:38+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4299"}],"name":"Predicting Airline Delays (PySpark)","id":"2DEEJ6253","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}