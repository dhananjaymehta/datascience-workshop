{"paragraphs":[{"text":"%angular\n\n<h3><b>TMDB 5000 Movie Dataset</b></h3>\nMetadata on ~5,000 movies from TMDb\n<br>Source: <a href=\"https://www.kaggle.com/tmdb/tmdb-movie-metadata/data\">Kaggle TMDB Movie Dataset</a>\n<br>\n<br><b>Background:</b>\n<br>What can we say about the success of a movie before it is released? Are there certain companies (Pixar?) that have found a consistent formula? Given that major films costing over $100 million to produce can still flop, this question is more important than ever to the industry. Film aficionados might have different interests. Can we predict which films will be highly rated, whether or not they are a commercial success?\n<br>\n<br><b>Analysis Goals:</b>\n<br>The goal of this notebook is to demonstrate basic Spark text analytics against a set of unstructured data (movie title and movie overview). The results of the text analysis can tehn be paired with structured data (film budget, release date, runtime, etc) to predict movie revenue by implementing a machine learning model.\n<br>\n<br>","dateUpdated":"2018-05-11T14:11:18+0000","config":{"tableHide":true,"editorSetting":{"language":"text","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/undefined","editorHide":false,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<h3><b>TMDB 5000 Movie Dataset</b></h3>\nMetadata on ~5,000 movies from TMDb\n<br>Source: <a href=\"https://www.kaggle.com/tmdb/tmdb-movie-metadata/data\">Kaggle TMDB Movie Dataset</a>\n<br>\n<br><b>Background:</b>\n<br>What can we say about the success of a movie before it is released? Are there certain companies (Pixar?) that have found a consistent formula? Given that major films costing over $100 million to produce can still flop, this question is more important than ever to the industry. Film aficionados might have different interests. Can we predict which films will be highly rated, whether or not they are a commercial success?\n<br>\n<br><b>Analysis Goals:</b>\n<br>The goal of this notebook is to demonstrate basic Spark text analytics against a set of unstructured data (movie title and movie overview). The results of the text analysis can tehn be paired with structured data (film budget, release date, runtime, etc) to predict movie revenue by implementing a machine learning model.\n<br>\n<br>"}]},"apps":[],"jobName":"paragraph_1526042766824_1187589669","id":"20180403-144202_1219661617","dateCreated":"2018-05-11T12:46:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:162"},{"title":"Check Spark and Python Versions","text":"%pyspark\nimport sys\nprint('Spark Version:  ' + str(spark.version))\nprint('Python Version: ' + str(sys.version))\n","user":"kirk","dateUpdated":"2018-05-11T12:48:30+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spark Version:  2.0.2\nPython Version: 2.7.13 |Anaconda custom (64-bit)| (default, Dec 20 2016, 23:09:15) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]\n"}]},"apps":[],"jobName":"paragraph_1526042766829_1185665925","id":"20180404-231306_412604001","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:48:30+0000","dateFinished":"2018-05-11T12:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:163"},{"title":"Import Libraries","text":"%pyspark\n\nimport datetime, time \nimport re, random, sys\n\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.functions import monotonically_increasing_id, col, expr, when, concat, lit, udf, split\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.regression import GBTRegressor, LinearRegression, GeneralizedLinearRegression, RandomForestRegressor\nfrom pyspark.ml.classification import GBTClassifier, RandomForestClassifier\nfrom pyspark.ml.feature import VectorIndexer, VectorAssembler, StringIndexer, Bucketizer\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator, RegressionEvaluator\nfrom pyspark.ml.feature import HashingTF, IDF, Tokenizer, CountVectorizer\nfrom pyspark.ml.clustering import LDA, BisectingKMeans\n","user":"kirk","dateUpdated":"2018-05-11T12:54:46+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1526042766831_1186435422","id":"20171002-231600_106801054","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:54:46+0000","dateFinished":"2018-05-11T12:54:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:164"},{"title":"Load Rawdata","text":"%pyspark\n\n############################################################################################################\n#\n#   Load Rawdata\n#   Source: https://www.kaggle.com/tmdb/tmdb-movie-metadata\n#\n############################################################################################################\n\nschema = StructType([                                           \\\n    StructField(\"budget\", IntegerType(), True),                 \\\n    StructField(\"genres\", StringType(), True),                  \\\n    StructField(\"homepage\", StringType(), True),                \\\n    StructField(\"id\", StringType(), True),                      \\\n    StructField(\"keywords\", StringType(), True),                \\\n    StructField(\"original_language\", StringType(), True),       \\\n    StructField(\"original_title\", StringType(), True),          \\\n    StructField(\"overview\", StringType(), True),                \\\n    StructField(\"popularity\", FloatType(), True),               \\\n    StructField(\"production_companies\", StringType(), True),    \\\n    StructField(\"production_countries\", StringType(), True),    \\\n    StructField(\"release_date\", StringType(), True),            \\\n    StructField(\"revenue\", LongType(), True),                   \\\n    StructField(\"runtime\", IntegerType(), True),                \\\n    StructField(\"spoken_languages\", StringType(), True),        \\\n    StructField(\"status\", StringType(), True),                  \\\n    StructField(\"tagline\", StringType(), True),                 \\\n    StructField(\"title\", StringType(), True),                   \\\n    StructField(\"vote_average\", FloatType(), True),             \\\n    StructField(\"vote_count\", IntegerType(), True)])\n\nrawdata = spark.read.load('./datasets/tmdb_5000_movies.csv', \n    format=\"csv\", \n    header=True, \n    schema=schema, \n    inferSchema=False, \n    quote='\"', \n    escape='\"', \n    mode=\"DROPMALFORMED\")\n\nprint(\"Number of records in rawdata: \" + str(rawdata.count()))\n\nrawdata.createOrReplaceTempView('rawdata')\n","user":"kirk","dateUpdated":"2018-05-11T12:56:06+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Number of records in rawdata: 4803\n"}]},"apps":[],"jobName":"paragraph_1526042766832_1196823643","id":"20171001-182907_522031746","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:06+0000","dateFinished":"2018-05-11T12:56:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165"},{"title":"Display Rawdata","text":"%sql\n\nselect * from rawdata limit 20","user":"kirk","dateUpdated":"2018-05-11T12:56:13+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"budget\tgenres\thomepage\tid\tkeywords\toriginal_language\toriginal_title\toverview\tpopularity\tproduction_companies\tproduction_countries\trelease_date\trevenue\truntime\tspoken_languages\tstatus\ttagline\ttitle\tvote_average\tvote_count\n237000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.avatarmovie.com/\t19995\t[{\"id\": 1463, \"name\": \"culture clash\"}, {\"id\": 2964, \"name\": \"future\"}, {\"id\": 3386, \"name\": \"space war\"}, {\"id\": 3388, \"name\": \"space colony\"}, {\"id\": 3679, \"name\": \"society\"}, {\"id\": 3801, \"name\": \"space travel\"}, {\"id\": 9685, \"name\": \"futuristic\"}, {\"id\": 9840, \"name\": \"romance\"}, {\"id\": 9882, \"name\": \"space\"}, {\"id\": 9951, \"name\": \"alien\"}, {\"id\": 10148, \"name\": \"tribe\"}, {\"id\": 10158, \"name\": \"alien planet\"}, {\"id\": 10987, \"name\": \"cgi\"}, {\"id\": 11399, \"name\": \"marine\"}, {\"id\": 13065, \"name\": \"soldier\"}, {\"id\": 14643, \"name\": \"battle\"}, {\"id\": 14720, \"name\": \"love affair\"}, {\"id\": 165431, \"name\": \"anti war\"}, {\"id\": 193554, \"name\": \"power relations\"}, {\"id\": 206690, \"name\": \"mind and soul\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tAvatar\tIn the 22nd century, a paraplegic Marine is dispatched to the moon Pandora on a unique mission, but becomes torn between following orders and protecting an alien civilization.\t150.43758\t[{\"name\": \"Ingenious Film Partners\", \"id\": 289}, {\"name\": \"Twentieth Century Fox Film Corporation\", \"id\": 306}, {\"name\": \"Dune Entertainment\", \"id\": 444}, {\"name\": \"Lightstorm Entertainment\", \"id\": 574}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}, {\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}]\t12/10/09\t2787965087\t162\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}]\tReleased\tEnter the World of Pandora.\tAvatar\t7.2\t11800\n300000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}]\thttp://disney.go.com/disneypictures/pirates/\t285\t[{\"id\": 270, \"name\": \"ocean\"}, {\"id\": 726, \"name\": \"drug abuse\"}, {\"id\": 911, \"name\": \"exotic island\"}, {\"id\": 1319, \"name\": \"east india trading company\"}, {\"id\": 2038, \"name\": \"love of one's life\"}, {\"id\": 2052, \"name\": \"traitor\"}, {\"id\": 2580, \"name\": \"shipwreck\"}, {\"id\": 2660, \"name\": \"strong woman\"}, {\"id\": 3799, \"name\": \"ship\"}, {\"id\": 5740, \"name\": \"alliance\"}, {\"id\": 5941, \"name\": \"calypso\"}, {\"id\": 6155, \"name\": \"afterlife\"}, {\"id\": 6211, \"name\": \"fighter\"}, {\"id\": 12988, \"name\": \"pirate\"}, {\"id\": 157186, \"name\": \"swashbuckler\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}]\ten\tPirates of the Caribbean: At World's End\tCaptain Barbossa, long believed to be dead, has come back to life and is headed to the edge of the Earth with Will Turner and Elizabeth Swann. But nothing is quite as it seems.\t139.08261\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Second Mate Productions\", \"id\": 19936}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t5/19/07\t961000000\t169\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tAt the end of the world, the adventure begins.\tPirates of the Caribbean: At World's End\t6.9\t4500\n245000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 80, \"name\": \"Crime\"}]\thttp://www.sonypictures.com/movies/spectre/\t206647\t[{\"id\": 470, \"name\": \"spy\"}, {\"id\": 818, \"name\": \"based on novel\"}, {\"id\": 4289, \"name\": \"secret agent\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 14555, \"name\": \"mi6\"}, {\"id\": 156095, \"name\": \"british secret service\"}, {\"id\": 158431, \"name\": \"united kingdom\"}]\ten\tSpectre\tA cryptic message from Bond�۪s past sends him on a trail to uncover a sinister organization. While M battles political forces to keep the secret service alive, Bond peels back the layers of deceit to reveal the terrible truth behind SPECTRE.\t107.376785\t[{\"name\": \"Columbia Pictures\", \"id\": 5}, {\"name\": \"Danjaq\", \"id\": 10761}, {\"name\": \"B24\", \"id\": 69434}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t10/26/15\t880674609\t148\t[{\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}, {\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}, {\"iso_639_1\": \"it\", \"name\": \"Italiano\"}, {\"iso_639_1\": \"de\", \"name\": \"Deutsch\"}]\tReleased\tA Plan No One Escapes\tSpectre\t6.3\t4466\n250000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 80, \"name\": \"Crime\"}, {\"id\": 18, \"name\": \"Drama\"}, {\"id\": 53, \"name\": \"Thriller\"}]\thttp://www.thedarkknightrises.com/\t49026\t[{\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 853, \"name\": \"crime fighter\"}, {\"id\": 949, \"name\": \"terrorist\"}, {\"id\": 1308, \"name\": \"secret identity\"}, {\"id\": 1437, \"name\": \"burglar\"}, {\"id\": 3051, \"name\": \"hostage drama\"}, {\"id\": 3562, \"name\": \"time bomb\"}, {\"id\": 6969, \"name\": \"gotham city\"}, {\"id\": 7002, \"name\": \"vigilante\"}, {\"id\": 9665, \"name\": \"cover-up\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9990, \"name\": \"villainess\"}, {\"id\": 10044, \"name\": \"tragic hero\"}, {\"id\": 13015, \"name\": \"terrorism\"}, {\"id\": 14796, \"name\": \"destruction\"}, {\"id\": 18933, \"name\": \"catwoman\"}, {\"id\": 156082, \"name\": \"cat burglar\"}, {\"id\": 156395, \"name\": \"imax\"}, {\"id\": 173272, \"name\": \"flood\"}, {\"id\": 179093, \"name\": \"criminal underworld\"}, {\"id\": 230775, \"name\": \"batman\"}]\ten\tThe Dark Knight Rises\tFollowing the death of District Attorney Harvey Dent, Batman assumes responsibility for Dent's crimes to protect the late attorney's reputation and is subsequently hunted by the Gotham City Police Department. Eight years later, Batman encounters the mysterious Selina Kyle and the villainous Bane, a new terrorist leader who overwhelms Gotham's finest. The Dark Knight resurfaces to protect a city that has branded him an enemy.\t112.31295\t[{\"name\": \"Legendary Pictures\", \"id\": 923}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"DC Entertainment\", \"id\": 9993}, {\"name\": \"Syncopy\", \"id\": 9996}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t7/16/12\t1084939099\t165\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tThe Legend Ends\tThe Dark Knight Rises\t7.6\t9106\n260000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://movies.disney.com/john-carter\t49529\t[{\"id\": 818, \"name\": \"based on novel\"}, {\"id\": 839, \"name\": \"mars\"}, {\"id\": 1456, \"name\": \"medallion\"}, {\"id\": 3801, \"name\": \"space travel\"}, {\"id\": 7376, \"name\": \"princess\"}, {\"id\": 9951, \"name\": \"alien\"}, {\"id\": 10028, \"name\": \"steampunk\"}, {\"id\": 10539, \"name\": \"martian\"}, {\"id\": 10685, \"name\": \"escape\"}, {\"id\": 161511, \"name\": \"edgar rice burroughs\"}, {\"id\": 163252, \"name\": \"alien race\"}, {\"id\": 179102, \"name\": \"superhuman strength\"}, {\"id\": 190320, \"name\": \"mars civilization\"}, {\"id\": 195446, \"name\": \"sword and planet\"}, {\"id\": 207928, \"name\": \"19th century\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tJohn Carter\tJohn Carter is a war-weary, former military captain who's inexplicably transported to the mysterious and exotic planet of Barsoom (Mars) and reluctantly becomes embroiled in an epic conflict. It's a world on the brink of collapse, and Carter rediscovers his humanity when he realizes the survival of Barsoom and its people rests in his hands.\t43.926994\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t3/7/12\t284139100\t132\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tLost in our world, found in another.\tJohn Carter\t6.1\t2124\n258000000\t[{\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}]\thttp://www.sonypictures.com/movies/spider-man3/\t559\t[{\"id\": 851, \"name\": \"dual identity\"}, {\"id\": 1453, \"name\": \"amnesia\"}, {\"id\": 1965, \"name\": \"sandstorm\"}, {\"id\": 2038, \"name\": \"love of one's life\"}, {\"id\": 3446, \"name\": \"forgiveness\"}, {\"id\": 3986, \"name\": \"spider\"}, {\"id\": 4391, \"name\": \"wretch\"}, {\"id\": 4959, \"name\": \"death of a friend\"}, {\"id\": 5776, \"name\": \"egomania\"}, {\"id\": 5789, \"name\": \"sand\"}, {\"id\": 5857, \"name\": \"narcism\"}, {\"id\": 6062, \"name\": \"hostility\"}, {\"id\": 8828, \"name\": \"marvel comic\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9748, \"name\": \"revenge\"}]\ten\tSpider-Man 3\tThe seemingly invincible Spider-Man goes up against an all-new crop of villain ��� including the shape-shifting Sandman. While Spider-Man�۪s superpowers are altered by an alien organism, his alter ego, Peter Parker, deals with nemesis Eddie Brock and also gets caught up in a love triangle.\t115.699814\t[{\"name\": \"Columbia Pictures\", \"id\": 5}, {\"name\": \"Laura Ziskin Productions\", \"id\": 326}, {\"name\": \"Marvel Enterprises\", \"id\": 19551}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t5/1/07\t890871626\t139\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}]\tReleased\tThe battle within.\tSpider-Man 3\t5.9\t3576\n260000000\t[{\"id\": 16, \"name\": \"Animation\"}, {\"id\": 10751, \"name\": \"Family\"}]\thttp://disney.go.com/disneypictures/tangled/\t38757\t[{\"id\": 1562, \"name\": \"hostage\"}, {\"id\": 2343, \"name\": \"magic\"}, {\"id\": 2673, \"name\": \"horse\"}, {\"id\": 3205, \"name\": \"fairy tale\"}, {\"id\": 4344, \"name\": \"musical\"}, {\"id\": 7376, \"name\": \"princess\"}, {\"id\": 10336, \"name\": \"animation\"}, {\"id\": 33787, \"name\": \"tower\"}, {\"id\": 155658, \"name\": \"blonde woman\"}, {\"id\": 162219, \"name\": \"selfishness\"}, {\"id\": 163545, \"name\": \"healing power\"}, {\"id\": 179411, \"name\": \"based on fairy tale\"}, {\"id\": 179431, \"name\": \"duringcreditsstinger\"}, {\"id\": 215258, \"name\": \"healing gift\"}, {\"id\": 234183, \"name\": \"animal sidekick\"}]\ten\tTangled\tWhen the kingdom's most wanted-and most charming-bandit Flynn Rider hides out in a mysterious tower, he's taken hostage by Rapunzel, a beautiful and feisty tower-bound teen with 70 feet of magical, golden hair. Flynn's curious captor, who's looking for her ticket out of the tower where she's been locked away for years, strikes a deal with the handsome thief and the unlikely duo sets off on an action-packed escapade, complete with a super-cop horse, an over-protective chameleon and a gruff gang of pub thugs.\t48.68197\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Walt Disney Animation Studios\", \"id\": 6125}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t11/24/10\t591794936\t100\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tThey're taking adventure to new lengths.\tTangled\t7.4\t3330\n280000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://marvel.com/movies/movie/193/avengers_age_of_ultron\t99861\t[{\"id\": 8828, \"name\": \"marvel comic\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 10629, \"name\": \"vision\"}, {\"id\": 155030, \"name\": \"superhero team\"}, {\"id\": 179431, \"name\": \"duringcreditsstinger\"}, {\"id\": 180547, \"name\": \"marvel cinematic universe\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tAvengers: Age of Ultron\tWhen Tony Stark tries to jumpstart a dormant peacekeeping program, things go awry and Earth�۪s Mightiest Heroes are put to the ultimate test as the fate of the planet hangs in the balance. As the villainous Ultron emerges, it is up to The Avengers to stop him from enacting his terrible plans, and soon uneasy alliances and unexpected action pave the way for an epic and unique global adventure.\t134.27924\t[{\"name\": \"Marvel Studios\", \"id\": 420}, {\"name\": \"Prime Focus\", \"id\": 15357}, {\"name\": \"Revolution Sun Studios\", \"id\": 76043}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t4/22/15\t1405403694\t141\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tA New Age Has Come.\tAvengers: Age of Ultron\t7.3\t6767\n250000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 10751, \"name\": \"Family\"}]\thttp://harrypotter.warnerbros.com/harrypotterandthehalf-bloodprince/dvd/index.html\t767\t[{\"id\": 616, \"name\": \"witch\"}, {\"id\": 2343, \"name\": \"magic\"}, {\"id\": 3872, \"name\": \"broom\"}, {\"id\": 3884, \"name\": \"school of witchcraft\"}, {\"id\": 6333, \"name\": \"wizardry\"}, {\"id\": 10164, \"name\": \"apparition\"}, {\"id\": 10791, \"name\": \"teenage crush\"}, {\"id\": 12564, \"name\": \"werewolf\"}]\ten\tHarry Potter and the Half-Blood Prince\tAs Harry begins his sixth year at Hogwarts, he discovers an old book marked as 'Property of the Half-Blood Prince', and begins to learn more about Lord Voldemort's dark past.\t98.885635\t[{\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"Heyday Films\", \"id\": 7364}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t7/7/09\t933959197\t153\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tDark Secrets Revealed\tHarry Potter and the Half-Blood Prince\t7.4\t5293\n250000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\thttp://www.batmanvsupermandawnofjustice.com/\t209112\t[{\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 7002, \"name\": \"vigilante\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 9748, \"name\": \"revenge\"}, {\"id\": 163455, \"name\": \"super powers\"}, {\"id\": 195242, \"name\": \"clark kent\"}, {\"id\": 195243, \"name\": \"bruce wayne\"}, {\"id\": 229266, \"name\": \"dc extended universe\"}]\ten\tBatman v Superman: Dawn of Justice\tFearing the actions of a god-like Super Hero left unchecked, Gotham City�۪s own formidable, forceful vigilante takes on Metropolis�۪s most revered, modern-day savior, while the world wrestles with what sort of hero it really needs. And with Batman and Superman at war with one another, a new threat quickly arises, putting mankind in greater danger than it�۪s ever known before.\t155.79045\t[{\"name\": \"DC Comics\", \"id\": 429}, {\"name\": \"Atlas Entertainment\", \"id\": 507}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"DC Entertainment\", \"id\": 9993}, {\"name\": \"Cruel & Unusual Films\", \"id\": 9995}, {\"name\": \"RatPac-Dune Entertainment\", \"id\": 41624}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t3/23/16\t873260194\t151\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tJustice or revenge\tBatman v Superman: Dawn of Justice\t5.7\t7004\n270000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.superman.com\t1452\t[{\"id\": 83, \"name\": \"saving the world\"}, {\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 8872, \"name\": \"invulnerability\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 163420, \"name\": \"kryptonite\"}, {\"id\": 163455, \"name\": \"super powers\"}, {\"id\": 179102, \"name\": \"superhuman strength\"}, {\"id\": 202526, \"name\": \"lex luthor\"}]\ten\tSuperman Returns\tSuperman returns to discover his 5-year absence has allowed Lex Luthor to walk free, and that those he was closest too felt abandoned and have moved on. Luthor plots his ultimate revenge that could see millions killed and change the face of the planet forever, as well as ridding himself of the Man of Steel.\t57.925625\t[{\"name\": \"DC Comics\", \"id\": 429}, {\"name\": \"Legendary Pictures\", \"id\": 923}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"Bad Hat Harry Productions\", \"id\": 9168}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t6/28/06\t391081192\t154\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}, {\"iso_639_1\": \"de\", \"name\": \"Deutsch\"}]\tReleased\tnull\tSuperman Returns\t5.4\t1400\n200000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 53, \"name\": \"Thriller\"}, {\"id\": 80, \"name\": \"Crime\"}]\thttp://www.mgm.com/view/movie/234/Quantum-of-Solace/\t10764\t[{\"id\": 627, \"name\": \"killing\"}, {\"id\": 1568, \"name\": \"undercover\"}, {\"id\": 4289, \"name\": \"secret agent\"}, {\"id\": 156095, \"name\": \"british secret service\"}]\ten\tQuantum of Solace\tQuantum of Solace continues the adventures of James Bond after Casino Royale. Betrayed by Vesper, the woman he loved, 007 fights the urge to make his latest mission personal. Pursuing his determination to uncover the truth, Bond and M interrogate Mr. White, who reveals that the organization that blackmailed Vesper is far more complex and dangerous than anyone had imagined.\t107.92881\t[{\"name\": \"Eon Productions\", \"id\": 7576}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t10/30/08\t586090727\t106\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}, {\"iso_639_1\": \"it\", \"name\": \"Italiano\"}, {\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}, {\"iso_639_1\": \"de\", \"name\": \"Deutsch\"}]\tReleased\tFor love, for hate, for justice, for revenge.\tQuantum of Solace\t6.1\t2965\n200000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}]\thttp://disney.go.com/disneypictures/pirates/\t58\t[{\"id\": 616, \"name\": \"witch\"}, {\"id\": 663, \"name\": \"fortune teller\"}, {\"id\": 910, \"name\": \"bondage\"}, {\"id\": 911, \"name\": \"exotic island\"}, {\"id\": 1299, \"name\": \"monster\"}, {\"id\": 1316, \"name\": \"captain\"}, {\"id\": 1317, \"name\": \"card game\"}, {\"id\": 1319, \"name\": \"east india trading company\"}, {\"id\": 1461, \"name\": \"compass\"}, {\"id\": 3799, \"name\": \"ship\"}, {\"id\": 5600, \"name\": \"daughter\"}, {\"id\": 12988, \"name\": \"pirate\"}, {\"id\": 157186, \"name\": \"swashbuckler\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}]\ten\tPirates of the Caribbean: Dead Man's Chest\tCaptain Jack Sparrow works his way out of a blood debt with the ghostly Davey Jones, he also attempts to avoid eternal damnation.\t145.84738\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Second Mate Productions\", \"id\": 19936}]\t[{\"iso_3166_1\": \"JM\", \"name\": \"Jamaica\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}, {\"iso_3166_1\": \"BS\", \"name\": \"Bahamas\"}, {\"iso_3166_1\": \"DM\", \"name\": \"Dominica\"}]\t6/20/06\t1065659812\t151\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"tr\", \"name\": \"T\\u00fcrk\\u00e7e\"}, {\"iso_639_1\": \"el\", \"name\": \"\\u03b5\\u03bb\\u03bb\\u03b7\\u03bd\\u03b9\\u03ba\\u03ac\"}, {\"iso_639_1\": \"zh\", \"name\": \"\\u666e\\u901a\\u8bdd\"}]\tReleased\tJack is back!\tPirates of the Caribbean: Dead Man's Chest\t7.0\t5246\n255000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 37, \"name\": \"Western\"}]\thttp://disney.go.com/the-lone-ranger/\t57201\t[{\"id\": 1556, \"name\": \"texas\"}, {\"id\": 2673, \"name\": \"horse\"}, {\"id\": 5385, \"name\": \"survivor\"}, {\"id\": 5901, \"name\": \"texas ranger\"}, {\"id\": 9104, \"name\": \"partner\"}, {\"id\": 9503, \"name\": \"outlaw\"}, {\"id\": 10685, \"name\": \"escape\"}, {\"id\": 10909, \"name\": \"lawyer\"}, {\"id\": 13008, \"name\": \"train\"}, {\"id\": 178867, \"name\": \"lone ranger\"}, {\"id\": 179419, \"name\": \"comanche\"}, {\"id\": 222787, \"name\": \"the lone ranger\"}, {\"id\": 228232, \"name\": \"tonto\"}]\ten\tThe Lone Ranger\tThe Texas Rangers chase down a gang of outlaws led by Butch Cavendish, but the gang ambushes the Rangers, seemingly killing them all. One survivor is found, however, by an American Indian named Tonto, who nurses him back to health. The Ranger, donning a mask and riding a white stallion named Silver, teams up with Tonto to bring the unscrupulous gang and others of that ilk to justice.\t49.046955\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Infinitum Nihil\", \"id\": 2691}, {\"name\": \"Silver Bullet Productions (II)\", \"id\": 37380}, {\"name\": \"Blind Wink Productions\", \"id\": 37381}, {\"name\": \"Classic Media\", \"id\": 37382}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t7/3/13\t89289910\t149\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tNever Take Off the Mask\tThe Lone Ranger\t5.9\t2311\n225000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.manofsteel.com/\t49521\t[{\"id\": 83, \"name\": \"saving the world\"}, {\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 10761, \"name\": \"superhuman\"}, {\"id\": 14909, \"name\": \"alien invasion\"}, {\"id\": 161184, \"name\": \"reboot\"}, {\"id\": 163455, \"name\": \"super powers\"}, {\"id\": 229266, \"name\": \"dc extended universe\"}]\ten\tMan of Steel\tA young boy learns that he has extraordinary powers and is not of this earth. As a young man, he journeys to discover where he came from and what he was sent here to do. But the hero in him must emerge if he is to save the world from annihilation and become the symbol of hope for all mankind.\t99.39801\t[{\"name\": \"Legendary Pictures\", \"id\": 923}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"DC Entertainment\", \"id\": 9993}, {\"name\": \"Syncopy\", \"id\": 9996}, {\"name\": \"Cruel and Unusual Films\", \"id\": 78685}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t6/12/13\t662845518\t143\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tYou will believe that a man can fly.\tMan of Steel\t6.5\t6359\n225000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 10751, \"name\": \"Family\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\tnull\t2454\t[{\"id\": 818, \"name\": \"based on novel\"}, {\"id\": 855, \"name\": \"fictional place\"}, {\"id\": 1155, \"name\": \"brother sister relationship\"}, {\"id\": 2043, \"name\": \"lion\"}, {\"id\": 3714, \"name\": \"human being\"}, {\"id\": 4391, \"name\": \"wretch\"}, {\"id\": 4820, \"name\": \"leap in time\"}, {\"id\": 5144, \"name\": \"matter of life and death\"}, {\"id\": 6150, \"name\": \"faith\"}, {\"id\": 6464, \"name\": \"uncle\"}, {\"id\": 166930, \"name\": \"narnia\"}, {\"id\": 170362, \"name\": \"fantasy world\"}]\ten\tThe Chronicles of Narnia: Prince Caspian\tOne year after their incredible adventures in the Lion, the Witch and the Wardrobe, Peter, Edmund, Lucy and Susan Pevensie return to Narnia to aid a young prince whose life has been threatened by the evil King Miraz. Now, with the help of a colorful cast of new characters, including Trufflehunter the badger and Nikabrik the dwarf, the Pevensie clan embarks on an incredible quest to ensure that Narnia is returned to its rightful heir.\t53.978603\t[{\"name\": \"Walt Disney\", \"id\": 5888}, {\"name\": \"Walden Media\", \"id\": 10221}, {\"name\": \"Stillking Films\", \"id\": 11345}, {\"name\": \"Ozumi Films\", \"id\": 11440}, {\"name\": \"Propeler\", \"id\": 11441}, {\"name\": \"Silverbell Films\", \"id\": 11442}, {\"name\": \"Revolution Sun Studios\", \"id\": 76043}]\t[{\"iso_3166_1\": \"CZ\", \"name\": \"Czech Republic\"}, {\"iso_3166_1\": \"PL\", \"name\": \"Poland\"}, {\"iso_3166_1\": \"SI\", \"name\": \"Slovenia\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t5/15/08\t419651413\t150\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tHope has a new face.\tThe Chronicles of Narnia: Prince Caspian\t6.3\t1630\n220000000\t[{\"id\": 878, \"name\": \"Science Fiction\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}]\thttp://marvel.com/avengers_movie/\t24428\t[{\"id\": 242, \"name\": \"new york\"}, {\"id\": 5539, \"name\": \"shield\"}, {\"id\": 8828, \"name\": \"marvel comic\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 14909, \"name\": \"alien invasion\"}, {\"id\": 155030, \"name\": \"superhero team\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}, {\"id\": 179431, \"name\": \"duringcreditsstinger\"}, {\"id\": 180547, \"name\": \"marvel cinematic universe\"}]\ten\tThe Avengers\tWhen an unexpected enemy emerges and threatens global safety and security, Nick Fury, director of the international peacekeeping agency known as S.H.I.E.L.D., finds himself in need of a team to pull the world back from the brink of disaster. Spanning the globe, a daring recruitment effort begins!\t144.44864\t[{\"name\": \"Paramount Pictures\", \"id\": 4}, {\"name\": \"Marvel Studios\", \"id\": 420}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t4/25/12\t1519557910\t143\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tSome assembly required.\tThe Avengers\t7.4\t11776\n380000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\thttp://disney.go.com/pirates/index-on-stranger-tides.html#/video/\t1865\t[{\"id\": 658, \"name\": \"sea\"}, {\"id\": 1316, \"name\": \"captain\"}, {\"id\": 1860, \"name\": \"mutiny\"}, {\"id\": 1938, \"name\": \"sword\"}, {\"id\": 2569, \"name\": \"prime minister\"}, {\"id\": 3180, \"name\": \"sailing\"}, {\"id\": 3625, \"name\": \"silver\"}, {\"id\": 3799, \"name\": \"ship\"}, {\"id\": 4235, \"name\": \"duke\"}, {\"id\": 5938, \"name\": \"mermaid\"}, {\"id\": 12988, \"name\": \"pirate\"}, {\"id\": 13065, \"name\": \"soldier\"}, {\"id\": 14643, \"name\": \"battle\"}, {\"id\": 157186, \"name\": \"swashbuckler\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tPirates of the Caribbean: On Stranger Tides\tCaptain Jack Sparrow crosses paths with a woman from his past, and he's not sure if it's love -- or if she's a ruthless con artist who's using him to find the fabled Fountain of Youth. When she forces him aboard the Queen Anne's Revenge, the ship of the formidable pirate Blackbeard, Jack finds himself on an unexpected adventure in which he doesn't know who to fear more: Blackbeard or the woman from his past.\t135.41385\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Moving Picture Company (MPC)\", \"id\": 20478}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t5/14/11\t1045713802\t136\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}]\tReleased\tLive Forever Or Die Trying.\tPirates of the Caribbean: On Stranger Tides\t6.4\t4948\n225000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 35, \"name\": \"Comedy\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.sonypictures.com/movies/meninblack3/\t41154\t[{\"id\": 4379, \"name\": \"time travel\"}, {\"id\": 5455, \"name\": \"time machine\"}, {\"id\": 9951, \"name\": \"alien\"}, {\"id\": 174915, \"name\": \"fictional government agency\"}, {\"id\": 185668, \"name\": \"seeing the future\"}, {\"id\": 208756, \"name\": \"changing history\"}]\ten\tMen in Black 3\tAgents J (Will Smith) and K (Tommy Lee Jones) are back...in time. J has seen some inexplicable things in his 15 years with the Men in Black, but nothing, not even aliens, perplexes him as much as his wry, reticent partner. But when K's life and the fate of the planet are put at stake, Agent J will have to travel back in time to put things right. J discovers that there are secrets to the universe that K never told him - secrets that will reveal themselves as he teams up with the young Agent K (Josh Brolin) to save his partner, the agency, and the future of humankind.\t52.03518\t[{\"name\": \"Amblin Entertainment\", \"id\": 56}, {\"name\": \"Media Magik Entertainment\", \"id\": 5627}, {\"name\": \"Imagenation Abu Dhabi FZ\", \"id\": 6736}, {\"name\": \"Hemisphere Media Capital\", \"id\": 9169}, {\"name\": \"Parkes/MacDonald Productions\", \"id\": 11084}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t5/23/12\t624026776\t106\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tThey are back... in time.\tMen in Black 3\t6.2\t4160\n250000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\thttp://www.thehobbit.com/\t122917\t[{\"id\": 417, \"name\": \"corruption\"}, {\"id\": 603, \"name\": \"elves\"}, {\"id\": 604, \"name\": \"dwarves\"}, {\"id\": 606, \"name\": \"orcs\"}, {\"id\": 609, \"name\": \"middle-earth (tolkien)\"}, {\"id\": 611, \"name\": \"hobbit\"}, {\"id\": 12554, \"name\": \"dragon\"}, {\"id\": 14643, \"name\": \"battle\"}, {\"id\": 167982, \"name\": \"unlikely friendship\"}, {\"id\": 188270, \"name\": \"epic battle\"}, {\"id\": 234213, \"name\": \"sword and sorcery\"}]\ten\tThe Hobbit: The Battle of the Five Armies\tImmediately after the events of The Desolation of Smaug, Bilbo and the dwarves try to defend Erebor's mountain of treasure from others who claim it: the men of the ruined Laketown and the elves of Mirkwood. Meanwhile an army of Orcs led by Azog the Defiler is marching on Erebor, fueled by the rise of the dark lord Sauron. Dwarves, elves and men must unite, and the hope for Middle-Earth falls into Bilbo's hands.\t120.965744\t[{\"name\": \"WingNut Films\", \"id\": 11}, {\"name\": \"New Line Cinema\", \"id\": 12}, {\"name\": \"Warner Bros. Pictures\", \"id\": 174}, {\"name\": \"3Foot7\", \"id\": 7413}, {\"name\": \"Metro-Goldwyn-Mayer (MGM)\", \"id\": 8411}]\t[{\"iso_3166_1\": \"NZ\", \"name\": \"New Zealand\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t12/10/14\t956019788\t144\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tWitness the defining chapter of the Middle-Earth saga\tThe Hobbit: The Battle of the Five Armies\t7.1\t4760\n"}]},"apps":[],"jobName":"paragraph_1526042766833_1196438894","id":"20171002-231928_238341422","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:13+0000","dateFinished":"2018-05-11T12:56:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:166"},{"title":"Display Rawdata (Only showing selected columns)","text":"%sql\n\nselect budget, id, original_language, popularity, release_date, revenue, runtime, status, title, vote_average, vote_count from rawdata limit 20\n","user":"kirk","dateUpdated":"2018-05-11T12:56:17+0000","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"budget\tid\toriginal_language\tpopularity\trelease_date\trevenue\truntime\tstatus\ttitle\tvote_average\tvote_count\n237000000\t19995\ten\t150.43758\t12/10/09\t2787965087\t162\tReleased\tAvatar\t7.2\t11800\n300000000\t285\ten\t139.08261\t5/19/07\t961000000\t169\tReleased\tPirates of the Caribbean: At World's End\t6.9\t4500\n245000000\t206647\ten\t107.376785\t10/26/15\t880674609\t148\tReleased\tSpectre\t6.3\t4466\n250000000\t49026\ten\t112.31295\t7/16/12\t1084939099\t165\tReleased\tThe Dark Knight Rises\t7.6\t9106\n260000000\t49529\ten\t43.926994\t3/7/12\t284139100\t132\tReleased\tJohn Carter\t6.1\t2124\n258000000\t559\ten\t115.699814\t5/1/07\t890871626\t139\tReleased\tSpider-Man 3\t5.9\t3576\n260000000\t38757\ten\t48.68197\t11/24/10\t591794936\t100\tReleased\tTangled\t7.4\t3330\n280000000\t99861\ten\t134.27924\t4/22/15\t1405403694\t141\tReleased\tAvengers: Age of Ultron\t7.3\t6767\n250000000\t767\ten\t98.885635\t7/7/09\t933959197\t153\tReleased\tHarry Potter and the Half-Blood Prince\t7.4\t5293\n250000000\t209112\ten\t155.79045\t3/23/16\t873260194\t151\tReleased\tBatman v Superman: Dawn of Justice\t5.7\t7004\n270000000\t1452\ten\t57.925625\t6/28/06\t391081192\t154\tReleased\tSuperman Returns\t5.4\t1400\n200000000\t10764\ten\t107.92881\t10/30/08\t586090727\t106\tReleased\tQuantum of Solace\t6.1\t2965\n200000000\t58\ten\t145.84738\t6/20/06\t1065659812\t151\tReleased\tPirates of the Caribbean: Dead Man's Chest\t7.0\t5246\n255000000\t57201\ten\t49.046955\t7/3/13\t89289910\t149\tReleased\tThe Lone Ranger\t5.9\t2311\n225000000\t49521\ten\t99.39801\t6/12/13\t662845518\t143\tReleased\tMan of Steel\t6.5\t6359\n225000000\t2454\ten\t53.978603\t5/15/08\t419651413\t150\tReleased\tThe Chronicles of Narnia: Prince Caspian\t6.3\t1630\n220000000\t24428\ten\t144.44864\t4/25/12\t1519557910\t143\tReleased\tThe Avengers\t7.4\t11776\n380000000\t1865\ten\t135.41385\t5/14/11\t1045713802\t136\tReleased\tPirates of the Caribbean: On Stranger Tides\t6.4\t4948\n225000000\t41154\ten\t52.03518\t5/23/12\t624026776\t106\tReleased\tMen in Black 3\t6.2\t4160\n250000000\t122917\ten\t120.965744\t12/10/14\t956019788\t144\tReleased\tThe Hobbit: The Battle of the Five Armies\t7.1\t4760\n"}]},"apps":[],"jobName":"paragraph_1526042766838_1196054145","id":"20171003-001046_1186615245","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:17+0000","dateFinished":"2018-05-11T12:56:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:167"},{"title":"Frequency - Movie Language","text":"%sql\n\nselect * from (\nselect original_language, count(*) as freq from rawdata group by original_language order by freq desc) as a\nlimit 5","user":"kirk","dateUpdated":"2018-05-11T12:56:22+0000","config":{"editorSetting":{"language":"sql"},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"original_language\tfreq\nen\t4505\nfr\t70\nes\t32\nde\t27\nzh\t27\n"}]},"apps":[],"jobName":"paragraph_1526042766840_1193360903","id":"20171002-232154_399447310","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:22+0000","dateFinished":"2018-05-11T12:56:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168"},{"title":"Frequency - Movie Status","text":"%sql\n\nselect * from (\nselect status, count(*) as freq from rawdata group by status order by freq desc) as a\nlimit 5","user":"kirk","dateUpdated":"2018-05-11T12:56:23+0000","config":{"editorSetting":{"language":"sql"},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":296,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"status\tfreq\nReleased\t4795\nRumored\t5\nPost Production\t3\n"}]},"apps":[],"jobName":"paragraph_1526042766843_1194130400","id":"20171002-233012_1103538654","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:24+0000","dateFinished":"2018-05-11T12:56:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:169"},{"title":"Scatter (Revenue vs Average Vote)","text":"%sql\n\nselect * from (\nselect revenue,vote_average from rawdata) as a\nlimit 200","user":"kirk","dateUpdated":"2018-05-11T12:56:25+0000","config":{"editorSetting":{"language":"sql"},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"revenue\tvote_average\n2787965087\t7.2\n961000000\t6.9\n880674609\t6.3\n1084939099\t7.6\n284139100\t6.1\n890871626\t5.9\n591794936\t7.4\n1405403694\t7.3\n933959197\t7.4\n873260194\t5.7\n391081192\t5.4\n586090727\t6.1\n1065659812\t7.0\n89289910\t5.9\n662845518\t6.5\n419651413\t6.3\n1519557910\t7.4\n1045713802\t6.4\n624026776\t6.2\n956019788\t7.1\n752215857\t6.5\n310669540\t6.2\n958400000\t7.6\n372234864\t5.8\n550000000\t6.6\n1845034188\t7.5\n1153304495\t7.1\n303025485\t5.5\n1513528810\t6.5\n1108561013\t6.9\n783766341\t6.7\n1215439994\t6.8\n1025491110\t6.4\n459359555\t6.3\n743559607\t7.0\n836297228\t6.0\n1091405097\t5.8\n491868548\t5.7\n705717432\t6.5\n400062763\t6.3\n559852396\t5.8\n219851172\t5.1\n1066969703\t7.6\n371353001\t5.9\n1506249360\t7.3\n531865000\t6.7\n747862775\t7.5\n467365246\t7.4\n197687603\t5.5\n351040419\t7.3\n335154643\t6.2\n407602906\t6.7\n1123746996\t6.1\n786636033\t5.7\n331926147\t6.6\n538983207\t6.7\n343471816\t6.6\n521311860\t7.8\n258022233\t6.1\n769653595\t5.6\n325233863\t6.6\n183987723\t5.2\n356743061\t5.5\n748806957\t6.7\n543934787\t6.4\n1004558444\t8.2\n735099082\t7.7\n381509870\t6.0\n585174222\t7.4\n185770160\t7.0\n222104681\t5.1\n401128639\t5.2\n745000000\t5.9\n173000000\t5.3\n370541256\t7.6\n264218220\t5.9\n302469017\t5.6\n857611174\t8.0\n966550600\t6.7\n623933331\t6.6\n396600000\t5.8\n758539785\t7.0\n710644566\t7.3\n0\t4.8\n150962475\t5.9\n714766572\t7.6\n752600867\t6.0\n209154322\t6.2\n652105443\t7.8\n471222889\t7.1\n305875730\t6.4\n389681935\t4.9\n494878759\t7.5\n435000000\t5.9\n773328629\t7.9\n675120017\t8.1\n825532764\t8.1\n77000000\t6.5\n1021103568\t7.0\n207283925\t6.6\n333932083\t7.3\n353624124\t7.1\n653428261\t6.6\n215283742\t5.8\n181674817\t5.5\n299370084\t6.5\n798958165\t6.0\n433677183\t6.3\n440603537\t5.8\n415686217\t6.2\n449220945\t6.6\n709709780\t6.6\n167298192\t5.6\n938212738\t7.4\n895921036\t7.5\n624029371\t6.2\n585349010\t6.9\n474968763\t6.7\n623722818\t7.5\n374218673\t7.5\n603900354\t6.2\n413106170\t5.9\n373062864\t6.2\n424988211\t6.4\n1274219009\t7.3\n738599701\t6.7\n644571402\t6.8\n378858340\t7.2\n356613439\t6.5\n449326618\t6.6\n309979994\t6.3\n292817841\t5.1\n301000000\t5.5\n245527149\t5.7\n682330139\t7.1\n0\t5.5\n287594577\t5.7\n665692281\t6.7\n318502923\t4.7\n397850012\t6.5\n205366737\t6.4\n38992758\t5.5\n64459316\t6.0\n128388320\t5.9\n272912430\t6.7\n497409852\t6.9\n746921274\t6.4\n431971116\t5.8\n229147509\t5.3\n553799566\t6.4\n441818803\t6.0\n195735876\t5.5\n521170825\t6.7\n694713380\t6.8\n306941670\t7.1\n202026112\t5.9\n456758981\t7.3\n268031828\t5.6\n385680446\t7.4\n821708551\t6.8\n609123048\t7.6\n150680864\t5.3\n76932943\t4.9\n185258983\t7.0\n285444603\t6.3\n245360480\t5.3\n371876278\t5.4\n119269486\t5.7\n85131830\t5.9\n370569774\t6.6\n361832400\t6.0\n212011111\t6.9\n829000000\t6.1\n150406466\t5.8\n163712074\t6.1\n183345589\t6.0\n532950503\t7.3\n282570682\t6.1\n245724603\t6.6\n373552094\t6.5\n442824138\t7.3\n631744560\t6.9\n519311965\t7.0\n847423452\t7.4\n368871007\t6.8\n591739379\t6.2\n273339556\t6.3\n554987477\t6.4\n293329073\t6.2\n362637473\t5.6\n371940071\t6.7\n789804554\t7.7\n49554002\t6.3\n243843127\t5.0\n354248063\t6.2\n349424282\t6.1\n321887208\t6.7\n976475550\t7.5\n61648500\t5.4\n655011224\t7.5\n"}]},"apps":[],"jobName":"paragraph_1526042766844_1192206656","id":"20171002-233020_123657324","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:28+0000","dateFinished":"2018-05-11T12:56:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:170"},{"title":"Descriptive Stats","text":"%pyspark\n\n############################################################################################################\n#\n#   Descriptive Stats\n#       - Total Records\n#       - Variables and types\n#       - Category levels and numeric stats (min, max, avg, etc.)\n#       - Display Categories\n#       - Correlations\n#\n############################################################################################################\n\n#rawdata.show(10, True)\nprint('\\nTotal Records: ' + str(rawdata.count()) + '\\n')\nfor i in rawdata.dtypes: print(i)\n\nnumeric_columns = [c[0] for c in rawdata.dtypes if c[1] not in ['string']]\n\nrawdata.describe(numeric_columns + ['release_date']).show()\n\nrawdata.filter('revenue == 0').count()\n\nrawdata.groupBy('original_language').count().sort('count', ascending=False).show(15,False)\nrawdata.groupBy('status').count().sort('count', ascending=False).show(15,False)\nrawdata.groupBy('homepage').count().sort('count', ascending=False).show(15,False)\nrawdata.groupBy('release_date').count().sort('count', ascending=False).show(15,False)\n","user":"kirk","dateUpdated":"2018-05-11T12:56:34+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nTotal Records: 4803\n\n('budget', 'int')\n('genres', 'string')\n('homepage', 'string')\n('id', 'string')\n('keywords', 'string')\n('original_language', 'string')\n('original_title', 'string')\n('overview', 'string')\n('popularity', 'float')\n('production_companies', 'string')\n('production_countries', 'string')\n('release_date', 'string')\n('revenue', 'bigint')\n('runtime', 'int')\n('spoken_languages', 'string')\n('status', 'string')\n('tagline', 'string')\n('title', 'string')\n('vote_average', 'float')\n('vote_count', 'int')\n+-------+-------------------+------------------+--------------------+------------------+------------------+-----------------+------------+\n|summary|             budget|        popularity|             revenue|           runtime|      vote_average|       vote_count|release_date|\n+-------+-------------------+------------------+--------------------+------------------+------------------+-----------------+------------+\n|  count|               4803|              4803|                4803|              4801|              4803|             4803|        4802|\n|   mean|2.904503987528628E7| 21.49230058217635| 8.226063865167603E7|106.87585919600083| 6.092171562405494|690.2179887570269|        null|\n| stddev|4.072239125855034E7|31.816649824119484|1.6285710094282946E8|22.611934588844218|1.1946121651473864| 1234.58589077154|        null|\n|    min|                  0|               0.0|                   0|                 0|               0.0|                0|      1/1/00|\n|    max|          380000000|          875.5813|          2787965087|               338|              10.0|            13752|      9/9/97|\n+-------+-------------------+------------------+--------------------+------------------+------------------+-----------------+------------+\n\n+-----------------+-----+\n|original_language|count|\n+-----------------+-----+\n|en               |4505 |\n|fr               |70   |\n|es               |32   |\n|de               |27   |\n|zh               |27   |\n|hi               |19   |\n|ja               |16   |\n|it               |14   |\n|cn               |12   |\n|ru               |11   |\n|ko               |11   |\n|pt               |9    |\n|da               |7    |\n|sv               |5    |\n|fa               |4    |\n+-----------------+-----+\nonly showing top 15 rows\n\n+---------------+-----+\n|status         |count|\n+---------------+-----+\n|Released       |4795 |\n|Rumored        |5    |\n|Post Production|3    |\n+---------------+-----+\n\n+--------------------------------------------+-----+\n|homepage                                    |count|\n+--------------------------------------------+-----+\n|null                                        |3091 |\n|http://www.thehungergames.movie/            |4    |\n|http://www.missionimpossible.com/           |4    |\n|http://www.thehobbit.com/                   |3    |\n|http://www.transformersmovie.com/           |3    |\n|http://www.kungfupanda.com/                 |3    |\n|http://www.indianajones.com                 |2    |\n|http://www.munkyourself.com/                |2    |\n|http://www.howtotrainyourdragon.com/        |2    |\n|http://www.ironmanmovie.com/                |2    |\n|http://www.workandtheglory.com/             |2    |\n|http://disney.go.com/disneypictures/pirates/|2    |\n|http://www.lordoftherings.net/              |2    |\n|http://www.riomovies.com/                   |2    |\n|http://www.theamazingspiderman.com          |2    |\n+--------------------------------------------+-----+\nonly showing top 15 rows\n\n+------------+-----+\n|release_date|count|\n+------------+-----+\n|1/1/06      |10   |\n|1/1/02      |8    |\n|7/18/13     |7    |\n|10/22/99    |7    |\n|9/3/04      |7    |\n|12/25/14    |7    |\n|10/16/15    |6    |\n|1/1/07      |6    |\n|1/1/05      |6    |\n|9/30/11     |6    |\n|9/16/05     |6    |\n|1/1/03      |6    |\n|9/16/11     |6    |\n|10/10/08    |5    |\n|5/13/05     |5    |\n+------------+-----+\nonly showing top 15 rows\n\n"}]},"apps":[],"jobName":"paragraph_1526042766848_882483791","id":"20171001-183040_1823851373","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:35+0000","dateFinished":"2018-05-11T12:56:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:171"},{"title":"Identify correlated variables (Pearson Correlation Coefficient)","text":"%pyspark\n\nseen = []\nfor c1 in numeric_columns:\n    for c2 in numeric_columns:\n        correlation = rawdata.stat.corr(c1, c2)\n        if (correlation >= 0.50 or correlation <= -0.50) and (c1 != c2) and ((c1,c2) not in seen):\n            seen.append((c2,c1))\n            print(str(correlation) + '\\tcorrelation for ' + str(c1) + ' and ' + str(c2))\n\n","user":"kirk","dateUpdated":"2018-05-11T12:56:54+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.50541399876\tcorrelation for budget and popularity\n0.730822856924\tcorrelation for budget and revenue\n0.593180338131\tcorrelation for budget and vote_count\n0.644723504537\tcorrelation for popularity and revenue\n0.778129888136\tcorrelation for popularity and vote_count\n0.78148732621\tcorrelation for revenue and vote_count\n"}]},"apps":[],"jobName":"paragraph_1526042766860_878251553","id":"20180403-153143_1316308743","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:54+0000","dateFinished":"2018-05-11T12:57:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:172"},{"title":"Extract Genre from JSON","text":"%pyspark\n\ndef extract_genre(column_name):\n    import json\n    try:\n        genre = json.loads(column_name)[0]['name'].strip()\n        \n        if (genre=='Action') or (genre=='Adventure'):\n            genre = 'Action/Adventure'\n        elif (genre=='Fantasy') or (genre=='Science Fiction'):\n            genre = 'Science Fiction'\n        elif (genre=='Horror') or (genre=='Thriller'):\n            genre = 'Horror'\n        elif (genre=='Drama'):\n            genre = 'Drama'\n        elif (genre=='Comedy'):\n            genre = 'Comedy'\n        else:\n            genre = 'Other'\n        \n        return genre\n    except:\n        return 'Other'\n\nudf_extract_genre = udf(extract_genre, StringType())\n\nenriched1 = rawdata.withColumn(\"genre\", udf_extract_genre('genres'))\n\nenriched1.groupBy('genre').count().sort(col('count'), ascending=False).show(50,False)","user":"kirk","dateUpdated":"2018-05-11T12:56:59+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+-----+\n|genre           |count|\n+----------------+-----+\n|Drama           |1207 |\n|Action/Adventure|1093 |\n|Comedy          |1042 |\n|Other           |754  |\n|Horror          |494  |\n|Science Fiction |213  |\n+----------------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1526042766861_877866805","id":"20180403-162013_405267523","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:56:59+0000","dateFinished":"2018-05-11T12:57:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:173"},{"title":"Model Transformations (Extract Date Vars)","text":"%pyspark\n\njson_columns = ['genres','keywords','production_companies','production_countries','spoken_languages']\ntext_columns = ['original_title','overview','tagline','title']\ndrop_columns = json_columns + ['original_title','tagline','popularity','release_date','status','original_language','homepage']\n\n# Filter DF - Drop where revenue = 0\nenriched1 = enriched1.filter('revenue != 0 AND status ==\"Released\"')\n\n# Extract Date/Time Variables\ndef extract_year(date_var):\n    try:\n        year = datetime.datetime.strptime(date_var, '%m/%d/%y').year\n        if year >= 2018:\n            year = re.sub('^20','19',str(year))\n        return year\n    except:\n        return -1\n\ndef extract_month(date_var):\n    try:\n        return datetime.datetime.strptime(date_var, '%m/%d/%y').month\n    except:\n        return -1\n\ndef extract_day(date_var):\n    try:\n        return datetime.datetime.strptime(date_var, '%m/%d/%y').day\n    except:\n        return -1\n\nudf_year  = udf(extract_year, IntegerType())\nudf_month = udf(extract_month, IntegerType())\nudf_day   = udf(extract_day, IntegerType())\n\nenriched2 = enriched1.withColumn(\"year\", udf_year('release_date')) \\\n                     .withColumn(\"month\", udf_month('release_date')) \\\n                     .withColumn(\"day\", udf_day('release_date'))\n\nenriched2.describe(['year','month','day']).show()\n\nenriched2.createOrReplaceTempView('enriched2')\n","user":"kirk","dateUpdated":"2018-05-11T12:57:18+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+-----------------+------------------+\n|summary|              year|            month|               day|\n+-------+------------------+-----------------+------------------+\n|  count|              3262|             3375|              3375|\n|   mean|2003.5392397302269|6.981037037037037|15.490962962962962|\n| stddev| 9.439919238361462|3.357779736235656|  8.49344170386728|\n|    min|              1969|                1|                 1|\n|    max|              2016|               12|                31|\n+-------+------------------+-----------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1526042766863_878636302","id":"20171002-184842_1177830626","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T12:57:18+0000","dateFinished":"2018-05-11T12:57:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174"},{"title":"Derive Data-Driven Topics","text":"%pyspark\n\n############################################################################################################\n#\n#   Data-Driven Topics\n#\n############################################################################################################\n\nnumber_of_clusters = 25\n\ndef handle_encoding(text):\n    return \"\".join(i for i in text if ord(i)<128)\n\nudf_handle_encoding = udf(handle_encoding, StringType())\nclean_text = enriched2.withColumn(\"overview\", udf_handle_encoding('overview')) \\\n                      .withColumn(\"title\", udf_handle_encoding('title'))\n\ndef cleanup_text(text):\n    words = text.split()\n    \n    # Default list of Stopwords\n    stopwords_core = ['a', u'about', u'above', u'after', u'again', u'against', u'all', u'am', u'an', u'and', u'any', u'are', u'arent', u'as', u'at', \n    u'be', u'because', u'been', u'before', u'being', u'below', u'between', u'both', u'but', u'by', \n    u'can', 'cant', 'come', u'could', 'couldnt', \n    u'd', u'did', u'didn', u'do', u'does', u'doesnt', u'doing', u'dont', u'down', u'during', \n    u'each', \n    u'few', 'finally', u'for', u'from', u'further', \n    u'had', u'hadnt', u'has', u'hasnt', u'have', u'havent', u'having', u'he', u'her', u'here', u'hers', u'herself', u'him', u'himself', u'his', u'how', \n    u'i', u'if', u'in', u'into', u'is', u'isnt', u'it', u'its', u'itself', \n    u'just', \n    u'll', \n    u'm', u'many', u'me', u'might', u'more', u'most', u'must', u'my', u'myself', \n    u'no', u'nor', u'not', u'now', \n    u'o', u'of', u'off', u'on', u'once', u'only', u'or', u'other', u'our', u'ours', u'ourselves', u'out', u'over', u'own', \n    u'r', u're', \n    u's', 'said', u'same', u'she', u'should', u'shouldnt', u'so', u'some', u'such', \n    u't', u'than', u'that', 'thats', u'the', u'their', u'theirs', u'them', u'themselves', u'then', u'there', u'these', u'they', u'this', u'those', u'through', u'to', u'too',\n    u'under', u'until', u'up',\n    u'very', \n    u'was', u'wasnt', u'we', u'were', u'werent', u'what', u'when', u'where', u'which', u'while', u'who', u'whom', u'why', u'will', u'with', u'wont', u'would', \n    u'y', u'you', u'your', u'yours', u'yourself', u'yourselves']\n    \n    # Custom List of Stopwords - Add your own here\n    stopwords_custom = ['']\n    stopwords = stopwords_core + stopwords_custom\n    stopwords = [word.lower() for word in stopwords]    \n    \n    words_out = [re.sub('[^a-zA-Z0-9]','',word) for word in words]                                       # Remove special characters\n    words_out = [word.lower() for word in words_out if len(word)>2 and word.lower() not in stopwords]     # Remove stopwords and words under X length\n    return words_out\n\nudf_cleantext = udf(cleanup_text , ArrayType(StringType()))\nclean_text2   = clean_text.withColumn(\"words\", udf_cleantext('overview'))\n\n# Term Frequency Vectorization\ncv = CountVectorizer(inputCol=\"words\", outputCol=\"rawFeatures\", vocabSize = 1000)\ncvmodel = cv.fit(clean_text2)\nfeaturizedData = cvmodel.transform(clean_text2)\n\nvocab = cvmodel.vocabulary\nvocab_broadcast = sc.broadcast(vocab)\n\nidf = IDF(inputCol=\"rawFeatures\", outputCol=\"features\")\nidfModel = idf.fit(featurizedData)\nrescaledData = idfModel.transform(featurizedData)\n\n# LDA Clustering - Find Data-driven Topics\nlda = LDA(k=number_of_clusters, seed=123, optimizer=\"em\", featuresCol=\"features\")\n\nldamodel = lda.fit(rescaledData)\n\n#ldamodel.isDistributed()\n#ldamodel.vocabSize()\n\nldatopics = ldamodel.describeTopics()\n#ldatopics.show(number_of_clusters)\n\ndef map_termID_to_Word(termIndices):\n    words = []\n    for termID in termIndices:\n        words.append(vocab_broadcast.value[termID])\n    \n    return words\n\nudf_map_termID_to_Word = udf(map_termID_to_Word , ArrayType(StringType()))\nldatopics_mapped = ldatopics.withColumn(\"topic_desc\", udf_map_termID_to_Word(ldatopics.termIndices))\nldatopics_mapped.select(ldatopics_mapped.topic, ldatopics_mapped.topic_desc).show(number_of_clusters,False)\n\nldaResults = ldamodel.transform(rescaledData)\n\n#ldaResults.show()\n\n# Breakout LDA Topics for Modeling and Reporting\ndef breakout_array(index_number, record):\n    vectorlist = record.tolist()\n    return vectorlist[index_number]\n\nudf_breakout_array = udf(breakout_array, FloatType())\n\nfor index_number in range(number_of_clusters):\n    column_name  = \"Topic_\" + str(index_number)\n    ldaResults = ldaResults.withColumn(column_name, udf_breakout_array(lit(index_number), ldaResults.topicDistribution))          \n\n# I needed to create multiple Drop statements here. In newer versions of spark (Spark 2.1+) you can use one drop statement with many columns.\ntext_enriched = ldaResults.drop('words').drop('rawFeatures').drop('features').drop('topicDistribution')\n\ntext_enriched.createOrReplaceTempView('text_enriched')\n","user":"kirk","dateUpdated":"2018-05-11T14:11:43+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----------------------------------------------------------------------------------+\n|topic|topic_desc                                                                         |\n+-----+-----------------------------------------------------------------------------------+\n|0    |[jason, rose, jack, universe, george, slave, time, life, competition, young]       |\n|1    |[alice, nick, hunter, survivors, deadly, continues, whether, stop, virus, children]|\n|2    |[cause, life, new, one, world, gang, two, get, man, war]                           |\n|3    |[charlie, computer, david, state, political, secret, smith, service, genius, reach]|\n|4    |[sex, richard, play, although, robot, face, make, video, girls, late]              |\n|5    |[hidden, real, america, world, man, dreams, new, becoming, life, one]              |\n|6    |[shop, sarah, change, seeking, search, life, beauty, two, one, cia]                |\n|7    |[planet, alien, earth, serial, killers, eddie, aliens, crew, killer, partner]      |\n|8    |[king, dragon, arthur, rule, love, woman, new, champion, vengeance, life]          |\n|9    |[harry, students, vacation, gang, school, lee, office, form, one, fate]            |\n|10   |[resistance, game, peter, world, story, desert, war, battle, future, leader]       |\n|11   |[mike, eye, since, jane, retired, spy, seek, stories, sheriff, looking]            |\n|12   |[max, jimmy, jim, animal, land, forest, theres, ago, attorney, family]             |\n|13   |[bond, basketball, general, player, james, team, school, scheme, north, sam]       |\n|14   |[bank, sons, green, daughters, knows, agent, world, robert, two, new]              |\n|15   |[christmas, band, eve, tells, remote, story, rock, murderer, love, called]         |\n|16   |[train, rachel, ocean, making, traveling, sexual, embark, realize, man, station]   |\n|17   |[alex, manager, one, girls, new, every, family, soul, parents, still]              |\n|18   |[coach, football, ryan, mark, team, peter, star, scene, changes, life]             |\n|19   |[queen, danny, white, snow, aging, evil, king, grown, prince, vegas]               |\n|20   |[vampire, hotel, tommy, humans, vampires, murders, movie, hospital, threat, life]  |\n|21   |[carter, tom, loves, lucy, magic, love, henry, realizes, life, neighborhood]       |\n|22   |[irish, uncle, school, film, south, life, family, new, relationship, relationships]|\n|23   |[arts, joe, new, music, eccentric, war, world, life, male, dealer]                 |\n|24   |[operation, gift, survive, society, mind, world, dangerous, agent, fbi, professor] |\n+-----+-----------------------------------------------------------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1526042766864_889024523","id":"20171003-000136_1941824235","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T13:06:01+0000","dateFinished":"2018-05-11T13:06:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:175"},{"title":"Display Transformed Dataset","text":"%sql\n\nSELECT id,title,budget,genre,original_language,popularity,release_date,year,month,day,runtime,vote_average, vote_count, revenue,overview, Topic_0, Topic_1, Topic_2, Topic_3, Topic_4, Topic_5 \nFROM text_enriched\nLIMIT 25\n","user":"kirk","dateUpdated":"2018-05-11T14:12:26+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\ttitle\tbudget\tgenre\toriginal_language\tpopularity\trelease_date\tyear\tmonth\tday\truntime\tvote_average\tvote_count\trevenue\toverview\tTopic_0\tTopic_1\tTopic_2\tTopic_3\tTopic_4\tTopic_5\n19995\tAvatar\t237000000\tAction/Adventure\ten\t150.43758\t12/10/09\t2009\t12\t10\t162\t7.2\t11800\t2787965087\tIn the 22nd century, a paraplegic Marine is dispatched to the moon Pandora on a unique mission, but becomes torn between following orders and protecting an alien civilization.\t0.039428666\t0.03671799\t0.035667088\t0.034588963\t0.036508374\t0.03640536\n285\tPirates of the Caribbean: At World's End\t300000000\tAction/Adventure\ten\t139.08261\t5/19/07\t2007\t5\t19\t169\t6.9\t4500\t961000000\tCaptain Barbossa, long believed to be dead, has come back to life and is headed to the edge of the Earth with Will Turner and Elizabeth Swann. But nothing is quite as it seems.\t0.039432462\t0.0360917\t0.03445257\t0.031628165\t0.036634795\t0.033246063\n206647\tSpectre\t245000000\tAction/Adventure\ten\t107.376785\t10/26/15\t2015\t10\t26\t148\t6.3\t4466\t880674609\tA cryptic message from Bonds past sends him on a trail to uncover a sinister organization. While M battles political forces to keep the secret service alive, Bond peels back the layers of deceit to reveal the terrible truth behind SPECTRE.\t0.030443773\t0.027224956\t0.028637893\t0.23914795\t0.023437608\t0.0335174\n49026\tThe Dark Knight Rises\t250000000\tAction/Adventure\ten\t112.31295\t7/16/12\t2012\t7\t16\t165\t7.6\t9106\t1084939099\tFollowing the death of District Attorney Harvey Dent, Batman assumes responsibility for Dent's crimes to protect the late attorney's reputation and is subsequently hunted by the Gotham City Police Department. Eight years later, Batman encounters the mysterious Selina Kyle and the villainous Bane, a new terrorist leader who overwhelms Gotham's finest. The Dark Knight resurfaces to protect a city that has branded him an enemy.\t0.033307105\t0.034712166\t0.04423525\t0.03574672\t0.04305659\t0.041353468\n49529\tJohn Carter\t260000000\tAction/Adventure\ten\t43.926994\t3/7/12\t2012\t3\t7\t132\t6.1\t2124\t284139100\tJohn Carter is a war-weary, former military captain who's inexplicably transported to the mysterious and exotic planet of Barsoom (Mars) and reluctantly becomes embroiled in an epic conflict. It's a world on the brink of collapse, and Carter rediscovers his humanity when he realizes the survival of Barsoom and its people rests in his hands.\t0.034988813\t0.031215487\t0.02736273\t0.031967245\t0.025289785\t0.027835134\n559\tSpider-Man 3\t258000000\tScience Fiction\ten\t115.699814\t5/1/07\t2007\t5\t1\t139\t5.9\t3576\t890871626\tThe seemingly invincible Spider-Man goes up against an all-new crop of villain  including the shape-shifting Sandman. While Spider-Mans superpowers are altered by an alien organism, his alter ego, Peter Parker, deals with nemesis Eddie Brock and also gets caught up in a love triangle.\t0.03596043\t0.03258655\t0.032531492\t0.031033268\t0.036189843\t0.03910674\n38757\tTangled\t260000000\tOther\ten\t48.68197\t11/24/10\t2010\t11\t24\t100\t7.4\t3330\t591794936\tWhen the kingdom's most wanted-and most charming-bandit Flynn Rider hides out in a mysterious tower, he's taken hostage by Rapunzel, a beautiful and feisty tower-bound teen with 70 feet of magical, golden hair. Flynn's curious captor, who's looking for her ticket out of the tower where she's been locked away for years, strikes a deal with the handsome thief and the unlikely duo sets off on an action-packed escapade, complete with a super-cop horse, an over-protective chameleon and a gruff gang of pub thugs.\t0.028224973\t0.031732313\t0.042508066\t0.02781374\t0.028195687\t0.057677235\n99861\tAvengers: Age of Ultron\t280000000\tAction/Adventure\ten\t134.27924\t4/22/15\t2015\t4\t22\t141\t7.3\t6767\t1405403694\tWhen Tony Stark tries to jumpstart a dormant peacekeeping program, things go awry and Earths Mightiest Heroes are put to the ultimate test as the fate of the planet hangs in the balance. As the villainous Ultron emerges, it is up to The Avengers to stop him from enacting his terrible plans, and soon uneasy alliances and unexpected action pave the way for an epic and unique global adventure.\t0.05081266\t0.041267335\t0.0681425\t0.036968183\t0.029099979\t0.035287984\n767\tHarry Potter and the Half-Blood Prince\t250000000\tAction/Adventure\ten\t98.885635\t7/7/09\t2009\t7\t7\t153\t7.4\t5293\t933959197\tAs Harry begins his sixth year at Hogwarts, he discovers an old book marked as 'Property of the Half-Blood Prince', and begins to learn more about Lord Voldemort's dark past.\t0.035375487\t0.031419527\t0.03658451\t0.031642124\t0.0351091\t0.035505075\n209112\tBatman v Superman: Dawn of Justice\t250000000\tAction/Adventure\ten\t155.79045\t3/23/16\t2016\t3\t23\t151\t5.7\t7004\t873260194\tFearing the actions of a god-like Super Hero left unchecked, Gotham Citys own formidable, forceful vigilante takes on Metropoliss most revered, modern-day savior, while the world wrestles with what sort of hero it really needs. And with Batman and Superman at war with one another, a new threat quickly arises, putting mankind in greater danger than its ever known before.\t0.030522857\t0.03613902\t0.03726845\t0.029368792\t0.028149128\t0.06551104\n1452\tSuperman Returns\t270000000\tAction/Adventure\ten\t57.925625\t6/28/06\t2006\t6\t28\t154\t5.4\t1400\t391081192\tSuperman returns to discover his 5-year absence has allowed Lex Luthor to walk free, and that those he was closest too felt abandoned and have moved on. Luthor plots his ultimate revenge that could see millions killed and change the face of the planet forever, as well as ridding himself of the Man of Steel.\t0.03691883\t0.031422783\t0.03565404\t0.029845718\t0.039389234\t0.043203253\n10764\tQuantum of Solace\t200000000\tAction/Adventure\ten\t107.92881\t10/30/08\t2008\t10\t30\t106\t6.1\t2965\t586090727\tQuantum of Solace continues the adventures of James Bond after Casino Royale. Betrayed by Vesper, the woman he loved, 007 fights the urge to make his latest mission personal. Pursuing his determination to uncover the truth, Bond and M interrogate Mr. White, who reveals that the organization that blackmailed Vesper is far more complex and dangerous than anyone had imagined.\t0.049548045\t0.08456433\t0.0315702\t0.0436415\t0.024690336\t0.029781308\n58\tPirates of the Caribbean: Dead Man's Chest\t200000000\tAction/Adventure\ten\t145.84738\t6/20/06\t2006\t6\t20\t151\t7.0\t5246\t1065659812\tCaptain Jack Sparrow works his way out of a blood debt with the ghostly Davey Jones, he also attempts to avoid eternal damnation.\t0.07175454\t0.033690535\t0.03495947\t0.051931534\t0.031898644\t0.033571377\n57201\tThe Lone Ranger\t255000000\tAction/Adventure\ten\t49.046955\t7/3/13\t2013\t7\t3\t149\t5.9\t2311\t89289910\tThe Texas Rangers chase down a gang of outlaws led by Butch Cavendish, but the gang ambushes the Rangers, seemingly killing them all. One survivor is found, however, by an American Indian named Tonto, who nurses him back to health. The Ranger, donning a mask and riding a white stallion named Silver, teams up with Tonto to bring the unscrupulous gang and others of that ilk to justice.\t0.027907588\t0.066403374\t0.051501263\t0.034747265\t0.037895665\t0.043804817\n49521\tMan of Steel\t225000000\tAction/Adventure\ten\t99.39801\t6/12/13\t2013\t6\t12\t143\t6.5\t6359\t662845518\tA young boy learns that he has extraordinary powers and is not of this earth. As a young man, he journeys to discover where he came from and what he was sent here to do. But the hero in him must emerge if he is to save the world from annihilation and become the symbol of hope for all mankind.\t0.040971693\t0.04459453\t0.04220149\t0.03627735\t0.03713758\t0.049999185\n2454\tThe Chronicles of Narnia: Prince Caspian\t225000000\tAction/Adventure\ten\t53.978603\t5/15/08\t2008\t5\t15\t150\t6.3\t1630\t419651413\tOne year after their incredible adventures in the Lion, the Witch and the Wardrobe, Peter, Edmund, Lucy and Susan Pevensie return to Narnia to aid a young prince whose life has been threatened by the evil King Miraz. Now, with the help of a colorful cast of new characters, including Trufflehunter the badger and Nikabrik the dwarf, the Pevensie clan embarks on an incredible quest to ensure that Narnia is returned to its rightful heir.\t0.047906037\t0.053056724\t0.030673012\t0.030988647\t0.026949987\t0.044815533\n24428\tThe Avengers\t220000000\tScience Fiction\ten\t144.44864\t4/25/12\t2012\t4\t25\t143\t7.4\t11776\t1519557910\tWhen an unexpected enemy emerges and threatens global safety and security, Nick Fury, director of the international peacekeeping agency known as S.H.I.E.L.D., finds himself in need of a team to pull the world back from the brink of disaster. Spanning the globe, a daring recruitment effort begins!\t0.048564624\t0.19540069\t0.05257836\t0.047246147\t0.029882247\t0.03618144\n1865\tPirates of the Caribbean: On Stranger Tides\t380000000\tAction/Adventure\ten\t135.41385\t5/14/11\t2011\t5\t14\t136\t6.4\t4948\t1045713802\tCaptain Jack Sparrow crosses paths with a woman from his past, and he's not sure if it's love -- or if she's a ruthless con artist who's using him to find the fabled Fountain of Youth. When she forces him aboard the Queen Anne's Revenge, the ship of the formidable pirate Blackbeard, Jack finds himself on an unexpected adventure in which he doesn't know who to fear more: Blackbeard or the woman from his past.\t0.0895245\t0.036258332\t0.032660633\t0.026514664\t0.026257394\t0.030934148\n41154\tMen in Black 3\t225000000\tAction/Adventure\ten\t52.03518\t5/23/12\t2012\t5\t23\t106\t6.2\t4160\t624026776\tAgents J (Will Smith) and K (Tommy Lee Jones) are back...in time. J has seen some inexplicable things in his 15 years with the Men in Black, but nothing, not even aliens, perplexes him as much as his wry, reticent partner. But when K's life and the fate of the planet are put at stake, Agent J will have to travel back in time to put things right. J discovers that there are secrets to the universe that K never told him - secrets that will reveal themselves as he teams up with the young Agent K (Josh Brolin) to save his partner, the agency, and the future of humankind.\t0.086976424\t0.02125558\t0.027927494\t0.06050619\t0.02097831\t0.030029783\n122917\tThe Hobbit: The Battle of the Five Armies\t250000000\tAction/Adventure\ten\t120.965744\t12/10/14\t2014\t12\t10\t144\t7.1\t4760\t956019788\tImmediately after the events of The Desolation of Smaug, Bilbo and the dwarves try to defend Erebor's mountain of treasure from others who claim it: the men of the ruined Laketown and the elves of Mirkwood. Meanwhile an army of Orcs led by Azog the Defiler is marching on Erebor, fueled by the rise of the dark lord Sauron. Dwarves, elves and men must unite, and the hope for Middle-Earth falls into Bilbo's hands.\t0.040289566\t0.034352947\t0.058142282\t0.03402994\t0.030228542\t0.044458084\n1930\tThe Amazing Spider-Man\t215000000\tAction/Adventure\ten\t89.86628\t6/27/12\t2012\t6\t27\t136\t6.5\t6586\t752215857\tPeter Parker is an outcast high schooler abandoned by his parents as a boy, leaving him to be raised by his Uncle Ben and Aunt May. Like most teenagers, Peter is trying to figure out who he is and how he got to be the person he is today. As Peter discovers a mysterious briefcase that belonged to his father, he begins a quest to understand his parents' disappearance  leading him directly to Oscorp and the lab of Dr. Curt Connors, his father's former partner. As Spider-Man is set on a collision course with Connors' alter ego, The Lizard, Peter will make life-altering choices to use his powers and shape his destiny to become a hero.\t0.020937119\t0.01886892\t0.023410052\t0.022628166\t0.027804354\t0.030049024\n20662\tRobin Hood\t200000000\tAction/Adventure\ten\t37.6683\t5/12/10\t2010\t5\t12\t140\t6.2\t1398\t310669540\tWhen soldier Robin happens upon the dying Robert of Loxley, he promises to return the man's sword to his family in Nottingham. There, he assumes Robert's identity; romances his widow, Marion; and draws the ire of the town's sheriff and King John's henchman, Godfrey.\t0.050753437\t0.035419315\t0.03207513\t0.02878431\t0.029105108\t0.035651367\n57158\tThe Hobbit: The Desolation of Smaug\t250000000\tAction/Adventure\ten\t94.37057\t12/11/13\t2013\t12\t11\t161\t7.6\t4524\t958400000\tThe Dwarves, Bilbo and Gandalf have successfully escaped the Misty Mountains, and Bilbo has gained the One Ring. They all continue their journey to get their gold back from the Dragon, Smaug.\t0.03485284\t0.032747127\t0.041379336\t0.040258396\t0.035119284\t0.034297023\n2268\tThe Golden Compass\t180000000\tAction/Adventure\ten\t42.990906\t12/4/07\t2007\t12\t4\t113\t5.8\t1303\t372234864\tAfter overhearing a shocking secret, precocious orphan Lyra Belacqua trades her carefree existence roaming the halls of Jordan College for an otherworldly adventure in the far North, unaware that it's part of her destiny.\t0.035782456\t0.033521272\t0.03379125\t0.03863504\t0.031403057\t0.040273484\n254\tKing Kong\t207000000\tAction/Adventure\ten\t61.22601\t12/14/05\t2005\t12\t14\t187\t6.6\t2337\t550000000\tIn 1933 New York, an overly ambitious movie producer coerces his cast and hired ship crew to travel to mysterious Skull Island, where they encounter Kong, a giant ape who is immediately smitten with the leading lady.\t0.054623857\t0.040108006\t0.04248496\t0.025837492\t0.048361644\t0.033198763\n"}]},"apps":[],"jobName":"paragraph_1526042766865_888639774","id":"20171002-234013_1134996371","dateCreated":"2018-05-11T12:46:06+0000","dateStarted":"2018-05-11T14:11:48+0000","dateFinished":"2018-05-11T14:12:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:176"},{"title":"Random Split Dataset (Training & Testing) ","text":"%pyspark\n\n# Handle Null/Missing values\nmodelprep = text_enriched.na.fill(-1) \\\n                         .withColumn('revenue', col('revenue').cast('double'))\n\ntraining, testing = modelprep.randomSplit([0.80, 0.20], seed=12345)\n\nprint('Total Records:     ' + str(modelprep.count()))\nprint('Training Records:  ' + str(training.count()))\nprint('Testing Records:   ' + str(testing.count()))\n","dateUpdated":"2018-05-11T14:16:20+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Total Records:     3375\nTraining Records:  2646\nTesting Records:   729\n"}]},"apps":[],"jobName":"paragraph_1526042766874_886716029","id":"20180403-171221_1435851564","dateCreated":"2018-05-11T12:46:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:178","user":"kirk","dateFinished":"2018-05-11T14:18:28+0000","dateStarted":"2018-05-11T14:16:20+0000"},{"title":"Train Predictive Model ","text":"%pyspark\n\ntarget   = 'revenue_over_100M'\nfeatures = ['budget','runtime','vote_average','vote_count','year','month','day','genre_index'] + [\"Topic_\" + str(index_number) for index_number in range(number_of_clusters)]\n\n# Bucketize revenue (split at $100M)\nrevenue_splits     = [-float(\"inf\"), 100000000, float(\"inf\")]\nrevenue_bucketizer = Bucketizer(splits=revenue_splits, inputCol=\"revenue\", outputCol=\"revenue_over_100M\")\n\n# SI on genre\nsi  = StringIndexer(inputCol=\"genre\", outputCol=\"genre_index\")\n\n# Vectorizer\nva  = VectorAssembler(inputCols=features, outputCol=\"features\")\n\n# ML Models\ngbc = GBTClassifier(featuresCol=\"features\", labelCol=target, predictionCol=\"prediction\", maxDepth=5, maxBins=32, maxIter=20, seed=12345)\nrfc = RandomForestClassifier(featuresCol=\"features\", labelCol=target, predictionCol=\"prediction\", probabilityCol=\"probability\", numTrees=10, maxDepth=5, seed=12345)\n\n# Build Pipeline\npipeline = Pipeline(stages=[revenue_bucketizer, si, va, gbc])\n\nmlmodel_with_text = pipeline.fit(training)\n","dateUpdated":"2018-05-11T14:18:57+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1526042766875_886331280","id":"20180404-001228_1067570013","dateCreated":"2018-05-11T12:46:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:179","user":"kirk","dateFinished":"2018-05-11T14:22:52+0000","dateStarted":"2018-05-11T14:18:57+0000"},{"title":"Model Evaluation","text":"%pyspark\n\ndef evaluate_regression_model(model, test_df, label='label'):\n    predictions = model.transform(test_df)\n    #predictions.select(label, \"prediction\").show(30,False)\n    \n    evaluator = RegressionEvaluator(metricName=\"rmse\")  # rmse (default)|mse|r2|mae\n    RMSE = evaluator.evaluate(predictions)\n    print 'RMSE: ' + str(RMSE)\n    \n    evaluator = RegressionEvaluator(metricName=\"r2\")\n    R2 = evaluator.evaluate(predictions)\n    print 'R2:   ' + str(R2)\n    \n    return predictions\n\ndef evaluate_classification_model(model, test_df, label='label'):\n    predictions = model.transform(test_df)\n    #predictions.select(\"prediction\", label).show(30,False)\n    \n    # Select (prediction, true label) and compute test error\n    evaluator = MulticlassClassificationEvaluator(labelCol=label, predictionCol=\"prediction\", metricName=\"accuracy\")   # f1|weightedPrecision|weightedRecall|accuracy\n    accuracy = evaluator.evaluate(predictions)\n    print(\"Accuracy: \" + str(accuracy))\n    \n    return accuracy, predictions\n\n\n# Predictions\naccuracy_with_text, predictions_with_text = evaluate_classification_model(mlmodel_with_text, testing, label=target)\n\nprint('\\nAccuracy for Gradient Boosting (with text):  ' + str(accuracy_with_text))\n\npredictions_with_text.select('id','title','revenue','revenue_over_100M','prediction').sort(predictions_with_text.id).show(50,False)","dateUpdated":"2018-05-11T14:29:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy: 0.851851851852\n\nAccuracy for Gradient Boosting (with text):  0.851851851852\n+------+--------------------------------------------------------+------------+-----------------+----------+\n|id    |title                                                   |revenue     |revenue_over_100M|prediction|\n+------+--------------------------------------------------------+------------+-----------------+----------+\n|10003 |The Saint                                               |1.18063304E8|1.0              |1.0       |\n|10027 |Unleashed                                               |5.0871113E7 |0.0              |1.0       |\n|10029 |Very Bad Things                                         |9898412.0   |0.0              |0.0       |\n|10053 |When a Stranger Calls                                   |6.6966987E7 |0.0              |0.0       |\n|10054 |Spy Kids                                                |1.4793418E8 |1.0              |0.0       |\n|10065 |The Amityville Horror                                   |1.08047131E8|1.0              |0.0       |\n|10070 |Feast                                                   |658573.0    |0.0              |0.0       |\n|10073 |Date Movie                                              |4.8548426E7 |0.0              |0.0       |\n|10090 |Reno 911!: Miami                                        |2.0342161E7 |0.0              |0.0       |\n|10117 |Action Jackson                                          |2.0256975E7 |0.0              |0.0       |\n|10139 |Milk                                                    |5.4586584E7 |0.0              |0.0       |\n|10140 |The Chronicles of Narnia: The Voyage of the Dawn Treader|4.15686217E8|1.0              |1.0       |\n|10160 |A Nightmare on Elm Street 5: The Dream Child            |2.2168359E7 |0.0              |0.0       |\n|10189 |Pineapple Express                                       |1.01624843E8|1.0              |0.0       |\n|10191 |How to Train Your Dragon                                |4.94878759E8|1.0              |1.0       |\n|10195 |Thor                                                    |4.49326618E8|1.0              |1.0       |\n|10218 |Swingers                                                |4505922.0   |0.0              |0.0       |\n|10229 |A Walk to Remember                                      |4.1227069E7 |0.0              |0.0       |\n|102362|Dead Man Down                                           |1.8074539E7 |0.0              |0.0       |\n|10253 |Dragon Wars: D-War                                      |5.3587404E7 |0.0              |0.0       |\n|102651|Maleficent                                              |7.58539785E8|1.0              |1.0       |\n|10269 |Yentl                                                   |3.04E7      |0.0              |0.0       |\n|10283 |Friday the 13th Part VIII: Jason Takes Manhattan        |1.4E7       |0.0              |0.0       |\n|10314 |She's All That                                          |1.03166989E8|1.0              |0.0       |\n|10316 |The Ides of March                                       |7.5993061E7 |0.0              |0.0       |\n|10320 |The Ring Two                                            |1.61451538E8|1.0              |1.0       |\n|10329 |Congo                                                   |1.52022101E8|1.0              |0.0       |\n|10331 |Night of the Living Dead                                |3.0E7       |0.0              |0.0       |\n|10339 |Moby Dick                                               |1.04E7      |0.0              |0.0       |\n|10364 |Catch-22                                                |2.491167E7  |0.0              |0.0       |\n|10366 |Universal Soldier: The Return                           |1.0667893E7 |0.0              |0.0       |\n|103663|The Hunt                                                |1.68E7      |0.0              |0.0       |\n|10375 |D-Tox                                                   |6416302.0   |0.0              |0.0       |\n|10397 |Angela's Ashes                                          |13.0        |0.0              |0.0       |\n|10398 |Double Jeopardy                                         |1.77841558E8|1.0              |1.0       |\n|10431 |War                                                     |4.0452643E7 |0.0              |0.0       |\n|10437 |The Muppet Christmas Carol                              |2.7281507E7 |0.0              |0.0       |\n|10439 |Hocus Pocus                                             |3.9514713E7 |0.0              |0.0       |\n|10490 |Drop Dead Gorgeous                                      |1.0571408E7 |0.0              |0.0       |\n|10496 |Bats                                                    |10.0        |0.0              |0.0       |\n|10501 |The Road to El Dorado                                   |7.6432727E7 |0.0              |1.0       |\n|10533 |The Scarlet Letter                                      |1.0382407E7 |0.0              |0.0       |\n|10534 |White Squall                                            |1.03E7      |0.0              |0.0       |\n|10545 |The Hunchback of Notre Dame                             |1.00138851E8|1.0              |1.0       |\n|10559 |Frequency                                               |6.8106245E7 |0.0              |0.0       |\n|10564 |Where the Heart Is                                      |3.3771174E7 |0.0              |0.0       |\n|10567 |Dinosaur                                                |3.54248063E8|1.0              |1.0       |\n|10571 |Boys and Girls                                          |2.0627372E7 |0.0              |0.0       |\n|10586 |The Ghost and the Darkness                              |7.5E7       |0.0              |1.0       |\n|10591 |The Girl Next Door                                      |3.0411183E7 |0.0              |0.0       |\n+------+--------------------------------------------------------+------------+-----------------+----------+\nonly showing top 50 rows\n\n"}]},"apps":[],"jobName":"paragraph_1526042766876_884407536","id":"20180403-155112_2073476066","dateCreated":"2018-05-11T12:46:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:180","user":"kirk","dateFinished":"2018-05-11T14:32:05+0000","dateStarted":"2018-05-11T14:29:03+0000"},{"title":"Model Feature Importances","text":"%pyspark\n\nfeature_importance_vars = sorted([(features[i],feature) for i,feature in enumerate(mlmodel_with_text.stages[-1].featureImportances)], key=lambda x: x[1], reverse=True)\n\nprint('Feature Importances (descending):')\nfor f in feature_importance_vars:\n    print(f)\n","dateUpdated":"2018-05-11T14:32:36+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Feature Importances (descending):\n('vote_count', 0.24494914091465211)\n('budget', 0.10765410601359977)\n('year', 0.063723206622906745)\n('runtime', 0.055511267982854218)\n('vote_average', 0.04294095521663302)\n('genre_index', 0.042363739210927967)\n('month', 0.041757801929942183)\n('Topic_21', 0.029143408027039963)\n('Topic_7', 0.028138877080703811)\n('Topic_5', 0.021751335809626956)\n('Topic_11', 0.020935503904113688)\n('Topic_13', 0.02062219767817447)\n('day', 0.020606025976349984)\n('Topic_18', 0.019867894703286006)\n('Topic_6', 0.019841950276787396)\n('Topic_19', 0.018830068805947571)\n('Topic_1', 0.017186584042727458)\n('Topic_8', 0.016010220544585306)\n('Topic_0', 0.015472915576251814)\n('Topic_14', 0.015376174486766047)\n('Topic_4', 0.014733914143281155)\n('Topic_12', 0.014705876962352083)\n('Topic_15', 0.014472950033708279)\n('Topic_2', 0.012892509625318752)\n('Topic_3', 0.012599174598708587)\n('Topic_20', 0.011846074475206903)\n('Topic_17', 0.011025241976052631)\n('Topic_9', 0.010023173409013243)\n('Topic_23', 0.0090675414425304378)\n('Topic_10', 0.0076961700661772004)\n('Topic_24', 0.0075487807792346488)\n('Topic_16', 0.0066269028637070387)\n('Topic_22', 0.004078314820832536)\n"}]},"apps":[],"jobName":"paragraph_1526042766878_885177034","id":"20180405-002246_141443115","dateCreated":"2018-05-11T12:46:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:181","user":"kirk","dateFinished":"2018-05-11T14:32:37+0000","dateStarted":"2018-05-11T14:32:37+0000"},{"text":"%angular\n<br><b>Additional Comments:</b>\n<br>The point of this notebook was to show basic text analytics capabilities (mostly native to Spark). There are many additional libraries that are well suited for spark text analytics and are recommended, these include:\n<br>&nbsp;&bull;&nbsp;<a href=\"https://github.com/JohnSnowLabs/spark-nlp\">Spark NLP Library</a>\n<br>&nbsp;&bull;&nbsp;<a href=\"https://spacy.io/\">SpaCy</a>\n<br>&nbsp;&bull;&nbsp;<a href=\"http://textblob.readthedocs.io/en/dev/\">TextBlob</a>\n<br>\n<br>\n<b>Additional References:</b>\n<br><a href=\"https://community.hortonworks.com/articles/84781/spark-text-analytics-uncovering-data-driven-topics.html\">HCC Article</a> that details some of the code and throught process being this notebook.\n<br><a href=\"https://github.com/zaratsian/Spark\">Misc Spark Examples</a>\n<br>\n<br>","dateUpdated":"2018-05-11T14:33:59+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/undefined","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<br><b>Additional Comments:</b>\n<br>The point of this notebook was to show basic text analytics capabilities (mostly native to Spark). There are many additional libraries that are well suited for spark text analytics and are recommended, these include:\n<br>&nbsp;&bull;&nbsp;<a href=\"https://github.com/JohnSnowLabs/spark-nlp\">Spark NLP Library</a>\n<br>&nbsp;&bull;&nbsp;<a href=\"https://spacy.io/\">SpaCy</a>\n<br>&nbsp;&bull;&nbsp;<a href=\"http://textblob.readthedocs.io/en/dev/\">TextBlob</a>\n<br>\n<br>\n<b>Additional References:</b>\n<br><a href=\"https://community.hortonworks.com/articles/84781/spark-text-analytics-uncovering-data-driven-topics.html\">HCC Article</a> that details some of the code and throught process being this notebook.\n<br><a href=\"https://github.com/zaratsian/Spark\">Misc Spark Examples</a>\n<br>\n<br>"}]},"apps":[],"jobName":"paragraph_1526042766879_884792285","id":"20171003-000618_1445939972","dateCreated":"2018-05-11T12:46:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:182","user":"kirk","dateFinished":"2018-05-11T14:33:50+0000","dateStarted":"2018-05-11T14:33:46+0000"},{"text":"%angular\n","dateUpdated":"2018-05-11T12:46:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/undefined","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526042766880_870556575","id":"20180403-145402_101101298","dateCreated":"2018-05-11T12:46:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:183"}],"name":"Movie Text Analytics - Python","id":"2DFTP6FC6","angularObjects":{"2CYSFF4KX:shared_process":[],"2CZ7M5Z1U:shared_process":[],"2CZN4E536:shared_process":[],"2CXMXB6B9:shared_process":[],"2CX1UN2AM:shared_process":[],"2CVYP86A3:shared_process":[],"2CZPMT4AR:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}